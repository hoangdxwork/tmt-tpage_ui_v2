<div *ngIf="data && team" class="px-2">
	<!--Lọc theo Messages-->
	<div *ngIf="data.type != 2" class="{{data.is_admin ? 'is_admin' : 'is_client'}}">
      <div class="chat-body w-full">
          <div *ngIf="!data.is_admin" class="mr-2 flex flex-col justify-end">
              <tpage-avatar-facebook [shape]="'circle'" [size]="36"
                [psid]="data.from_id" [token]="team?.Facebook_PageToken">
              </tpage-avatar-facebook>
          </div>

          <!-- Tin nhắn văn bản -->
          <div *ngIf="data.message_formatted" class="message-inner {{data.error_message ? 'error' : ''}}"
              tds-tooltip tooltipTitle="{{data.DateCreated | yiDateTimeFormat}}">
              <div class="text-left" [innerHTML]="data.message_formatted | formatIconLike | safeHtml" #contentMessage></div>
          </div>

          <!-- Tin nhắn hình ảnh -->
		   <!-- 1 hình -->
		  <div *ngIf="data.message?.attachments && data.message.attachments.data.length==1" class="flex flex-wrap max-w-[225px]">
            <div *ngFor="let att of data.message.attachments.data" class="p-0.5 flex gap-x-2 justify-center items-center">
				<a class="flex items-center" [ngClass]="reloadingImage?'cursor-wait':''" *ngIf="data.errorShowAttachment" tds-tooltip tooltipTitle="Ảnh đã hết hạn" (click)="refreshAttachment(att)">
					<span class="tdsi-reload-fill text-primary-1 text-body-1 leading-none"></span>
				</a>
				<a *ngIf="att.image_data" (click)="open_gallery(att)">
					<show-attachment class="w-full h-full" [type]="att.mime_type" [height]="'225px'" [url]="att.image_data?.url" (onError)="isErrorAttachment(att, data)">
					</show-attachment>
				</a>
				<a *ngIf="att.video_data" (click)="open_gallery(att)">
					<show-attachment [type]="att.mime_type" [url]="att.video_data?.url"  (onError)="isErrorAttachment(att, data)"
						[width]="'320px'" [height]="'240px'" [isMuted]="false"></show-attachment>
				</a>
				<a *ngIf="att.file_url" container="body" (click)="open_gallery(att)">
					<show-attachment [type]="att.mime_type" [url]="att.file_url" (onError)="isErrorAttachment(att, data)">
					</show-attachment>
				</a>
            </div>
          </div>
		  <!-- Nhiều hình -->
          <div *ngIf="data.message?.attachments && data.message.attachments.data.length>1" class="flex flex-wrap w-[327px]">
            <div *ngFor="let att of data.message.attachments.data" class="p-0.5"
				[ngClass]="data.message.attachments.data.length==2?'w-1/2':'w-1/3'">
				<div class="w-full relative" [ngStyle]="{'padding-top.%': 100}">
					<a *ngIf="att.image_data" (click)="open_gallery(att)" class="absolute inset-0 w-full h-full flex">
						<show-attachment class="w-full h-full" [type]="att.mime_type" [url]="att.image_data?.url" (onError)="isErrorAttachment(att, data)">
						</show-attachment>
					</a>
					<a *ngIf="att.video_data" (click)="open_gallery(att)" class="absolute inset-0 w-full h-full flex">
						<show-attachment [type]="att.mime_type" [url]="att.video_data?.url"  (onError)="isErrorAttachment(att, data)"
							[width]="'320px'" [height]="'240px'" [isMuted]="false"></show-attachment>
					</a>
					<a *ngIf="att.file_url" container="body" (click)="open_gallery(att)" class="absolute inset-0 w-full h-full flex">
						<show-attachment [type]="att.mime_type" [url]="att.file_url" (onError)="isErrorAttachment(att, data)">
						</show-attachment>
					</a>
				</div>
            </div>
          </div>
		  <div *ngIf="data.message?.attachments && this.isShowItemImage == true">
		  	<show-item-image [lstImage]="listAtts" [team]="team" [data]="data" [name]="name" [imageClick]="imageClick"
			  (closeShowItemImage)="onCloseShowItemImage($event)">
			</show-item-image>
		  </div>

          <!-- Tin nhắn không tải được -->
          <div *ngIf="!data.message_formatted && !data.message?.attachments" class="message-inner text-left !text-accent-3 !bg-accent-3 !bg-opacity-20"
            tds-tooltip tooltipTitle="{{data.DateCreated | yiDateTimeFormat}}">
              Không tải được tin nhắn!
          </div>

          <!-- Tin nhắn lỗi -->
          <div *ngIf="data.error_message || data.status == enumActivityStatus.fail" class="select-message flex items-center">
              <a class="flex items-center cursor-pointer" *ngIf="!checkErrorMessage(data.error_message)" tds-popover [popoverContent]="popoverBug">
                  <span class="tdsi-info-line text-error-400 text-body-1 leading-none" ></span>
              </a>
              <a class="flex items-center cursor-pointer" *ngIf="checkErrorMessage(data.error_message)" tds-tooltip tooltipTitle="Gửi lại" (click)="retryMessage()">
                  <span class="tdsi-reload-fill text-primary-1 text-body-1 leading-none"></span>
              </a>
			  <ng-template #popoverBug>
				<div class="max-w-[336px]">{{data.error_message}}</div>
			  </ng-template>
          </div>

          <!-- Chọn số điện thoại, địa chỉ, ghi chú -->
          <div *ngIf="!data.message?.attachments" class="select-icon">
            <div class="select-order flex flex-row items-center w-fit h-full px-3">
				<span tds-tooltip tooltipTitle="Chọn làm số điện thoại"
					class="h-5 w-5 bg-base-green-400 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
					(click)="selectOrder('phone')">
					<i class="tdsi-call-fill text-md text-white"></i>
				</span>
				<span tds-tooltip tooltipTitle="Chọn làm địa chỉ"
					class="h-5 w-5 bg-base-orange-500 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
					(click)="selectOrder('address')">
					<i class="tdsi-pin-fill text-md text-white"></i>
				</span>
				<span tds-tooltip tooltipTitle="Thêm vào ghi chú"
					class="h-5 w-5 bg-base-blue-500 flex items-center justify-center rounded-md cursor-pointer"
					(click)="selectOrder('note')">
					<i class="tdsi-note-2-fill text-md text-white"></i>
				</span>
			</div>
          </div>
      </div>

      <!-- Đang gửi -->
      <span *ngIf="data.status == enumActivityStatus.sending" class="chat-by mr-2">
          <span class="tdsi-send-fill"></span> Đang gửi...
      </span>
      <!-- Người gửi -->
      <span *ngIf="data.error_message || data.status == enumActivityStatus.fail ; else seenBy">
		<span *ngIf="checkErrorMessage(data.error_message)" class="text-caption-2 text-neutral-1-400 gap-x-1 flex justify-end"><i class="tdsi-info-line flex items-center"></i>Tin nhắn chưa được gửi</span>
      </span>
	  <ng-template #seenBy>
		<span *ngIf="data.CreatedBy && data.status != enumActivityStatus.sending" class="chat-by">
			Được gửi bởi <span class="text-info-500"> {{data.CreatedBy.Name}}</span>
		</span>
	  </ng-template>
  </div>

	<!--Lọc theo comments-->
	<div *ngIf="data.comment" class="log-comment w-full mb-3 {{ data.is_admin ? 'is_admin' : 'is_client' }}">
		<div class="w-full flex flex-row">
			<!-- Avatar Facebook_PageId -->
			<div class="mr-2">
          <tpage-avatar-facebook [shape]="'circle'" [size]="36"
            [psid]="!data.is_admin ? data.from_id : team.Facebook_PageId" [token]="team?.Facebook_PageToken">
          </tpage-avatar-facebook>
			</div>
			<!-- comment block -->
			<div class="flex flex-col w-full commnent-block">
				<!--Chat chỉ gửi hình ảnh-->
				<div *ngIf="data.Image" class="img-outer">
					<img tds-image [tdsSrc]="data.Image" class="img-responsive img-thumbnail">
				</div>
				<!-- Hình ảnh -->
				<div *ngIf="data.comment?.attachment" class="pb-2 w-full">
					<img tds-image *ngIf="data.comment.attachment.type != 'sticker'"
						[tdsSrc]="data.comment.attachment.media.image.src" />
					<img tds-image *ngIf="data.comment.attachment.type == 'sticker'"
						[tdsSrc]="data.comment.attachment.media.image.src" />
				</div>
				<div class="inline-flex w-fit chat-main-block group">
					<!-- Nội dung bình luận -->
					<div class="chat-body w-full !m-0" tds-tooltip
						tooltipTitle="{{data.DateCreated | date:'dd'}}/{{data.DateCreated | date:'MM'}} {{data.DateCreated | date:'HH:mm'}}">
						<div class="chat-content bg-white px-4 py-2 rounded-b-xl rounded-r-xl">
							<div class="flex flex-auto">
								<!--Nội dung-->
								<div *ngIf="data.message_formatted">
									<div class="name font-semibold pb-1">{{data.comment.from.name}}</div>
									<div class="content-message font-regular" #contentMessage>{{data.comment.message}}
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- Lỗi gửi tin -->
					<div *ngIf="data.error_message || data.status == enumActivityStatus.fail">
						<span class="tdsi-information-fill" title="{{data.error_message}}"></span>
					</div>
					<!-- Thao tác -->
					<div *ngIf="!data.message?.attachments" class="chat-option invisible group-hover:visible">
						<div class="select-order flex flex-row items-center w-fit h-full pl-3">
							<span tds-tooltip tooltipTitle="Chọn làm số điện thoại"
								class="h-5 w-5 bg-base-green-400 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
								(click)="selectOrder('phone')">
								<i class="tdsi-call-fill text-md text-white"></i>
							</span>
							<span tds-tooltip tooltipTitle="Chọn làm địa chỉ"
								class="h-5 w-5 bg-base-orange-500 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
								(click)="selectOrder('address')">
								<i class="tdsi-pin-fill text-md text-white"></i>
							</span>
							<span tds-tooltip tooltipTitle="Thêm vào ghi chú"
								class="h-5 w-5 bg-base-blue-500 flex items-center justify-center rounded-md cursor-pointer"
								(click)="selectOrder('note')">
								<i class="tdsi-note-2-fill text-md text-white"></i>
							</span>
						</div>
					</div>
				</div>
				<!--Thích hiện ẩn + CreatedBy.Name-->
				<div class="chat-meta bg-transparent text-neutral-1-600 text-caption-2 font-regular mt-1.5">
					<div class="chat-acts flex flex-row items-center" style="position: relative;">

						<button class="link-act hover:underline" [disabled]="isReplyingComment"
					  		(click)="clickReply(data.comment ? data.comment.can_remove : null)"> Phản hồi
						</button>
						<span *ngIf="isReplyingComment" class="ml-1">
							<tds-spinner [color]="'primary'" class="w-2 h-2"></tds-spinner>
						</span>
						<div class="h-1 w-1 bg-neutral-1-300 rounded-full mx-2.5"></div>

						<button class="link-act hover:underline" [disabled]="isLiking" [ngClass]="data.comment.user_likes ? 'text-secondary-1' : ''"
							(click)="addLike(data.comment ? data.comment.can_like : null)">
							{{data.comment.user_likes ? 'Đã thích' : 'Thích'}}
						</button>

						<tds-spinner *ngIf="isLiking" [color]="'primary'" class="ml-1 w-2 h-2"></tds-spinner>
						<div class="h-1 w-1 bg-neutral-1-300 rounded-full mx-2.5"></div>

						<button class="link-act hover:underline" [disabled]="isHiding"
							(click)="hideComment(data.comment ? data.comment.can_hide: null)">
							{{data.comment.is_hidden ? 'Hiện' : 'Ẩn'}}
						</button>

						<tds-spinner *ngIf="isHiding" [color]="'primary'" class="ml-1 w-2 h-2"></tds-spinner>
						<div class="h-1 w-1 bg-neutral-1-300 rounded-full mx-2.5"></div>

						<span *ngIf="data.DateCreated" class="date-diff cursor-pointer hover:underline" tds-tooltip
							tooltipTitle="{{data.DateCreated | date:'dd'}} Tháng {{data.DateCreated | date:'MM'}}, {{data.DateCreated | date:'yyyy'}} lúc {{data.DateCreated | date:'HH:mm'}}">
							{{data.DateCreated | yiDiffDateTime}}
						</span>
					</div>

					<span class="chat-by font-regular" *ngIf="data.IsHandledBySystem && data.CreatedBy"> Được gửi bởi
						<span class="font-semibold" style="color: #03468b;">{{data.CreatedBy.Name}}</span>
					</span>
				</div>

				<!-- Input trả lời bình luận -->
				<div *ngIf="isReply == true" class="chat-reply relative flex flex-col gap-y-5 bg-white rounded-xl w-full p-4 mt-4 border-b-2 border-primary-1" >
					<div [ngClass]="isReplyingComment?'!cursor-wait':'hidden'" class="absolute top-0 left-0 z-10 w-full h-full opacity-100">
					</div>
					<div class="flex flex-row w-full">
						<textarea id="inputReply" #contentReply tdsInput placeholder="Nhập nội dung trả lời"
						[(ngModel)]="messageModel" [ngModelOptions]="{standalone: true}"
						class="w-full resize-none !p-0 !m-0 no-scrollbar">
					</textarea>
						<button tds-button type="button" color="primary" class="!rounded-full" [size]="'lg'" (click)="onEnter($event)">
						<span class="flex items-center px-5">
							<i class="tdsi-send-fill text-lg leading-none mr-2"></i> Gửi
						</span>
						</button>
					</div>
					<!-- Check Private Reply -->
					<div class="quick-message gap-5">
						<div class="check gap-5 flex justify-between">
							<div class="icon-send flex flex-row mr-2 gap-x-2 items-center">
								<a class="tdsi-emotion-line text-neutral-1-400 text-xl leading-none cursor-pointer p-2 hover:bg-neutral-3-50 rounded-md" 
									type="button" tds-tooltip tooltipTitle="Cảm xúc"
									tds-popover popoverTrigger="click"
									[popoverContent]="infoEmojiMart"
									[popoverAutoClose]="true"
									[popoverBackdrop]="true"
									popoverPlacement="top">
									<ng-template #infoEmojiMart>
										<div (loadEmojiMart)="loadEmojiMart($event)" icon-emoji-mart></div>
									</ng-template>
								</a>
								<div class="text-neutral-1-400 cursor-pointer p-2 rounded-md tdsi-product-line text-xl leading-none hover:bg-neutral-3-50" *ngIf="isPrivateReply"
									(onProductSelected)="onProductSelected($event)" tds-tooltip tooltipTitle="Sản phẩm">
								</div>
								<quick-reply-button class="p-2 rounded-md hover:bg-neutral-3-50" tds-tooltip tooltipTitle="Tin nhắn nhanh" (onQuickReplySelected)="onQuickReplySelected($event)"></quick-reply-button>
							</div>
							<tds-checkbox [checked]="isPrivateReply" (change)="changeIsPrivateReply()">
								Gửi về tin nhắn
							</tds-checkbox>
						</div>
					</div>
				</div>
				<!-- Phản hồi bình luận -->
				<div *ngIf="children" class="chat-list" @eventReplyComment>
					<div class="chat-item mt-4 chat-comment flex flex-row" *ngFor="let child of children; let i = index;">
						<div class="avatar mr-2">
							<tpage-avatar-facebook [shape]="'circle'" [size]="36" [psid]="child.from.id"
								[token]="team?.Facebook_PageToken">
							</tpage-avatar-facebook>
						</div>
						<div class="flex flex-col w-full">
							<div class="inline-flex w-fit group">
								<div class="chat-body !m-0" tds-tooltip
									tooltipTitle="{{child.created_time | date:'dd'}}/{{child.created_time | date:'MM'}} {{child.created_time | date:'HH:mm'}}">
									<div class="chat-content flex-auto bg-white px-4 py-2 rounded-b-xl rounded-r-xl">
										<div class="border-activety-comment" *ngIf="child.message_format">
											<div class="name font-semibold pb-1">{{child.from.name}}</div>
											<div class="content-message font-regular"
												[innerHTML]="child.message_format | safeHtml"></div>
										</div>
										<div class="border-activety-comment" *ngIf="!child.message_format">
											<div class="name font-semibold pb-1">{{child.from.name}}</div>
											<div class="content-message font-regular">{{child.message}}</div>
										</div>
									</div>
								</div>
								<div *ngIf="!child.message?.attachments"
									class="chat-option invisible group-hover:visible">
									<div class="select-order flex flex-row items-center w-fit h-full pl-3">
										<span tds-tooltip tooltipTitle="Chọn làm số điện thoại"
											class="h-5 w-5 bg-base-green-400 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
											(click)="selectOrder('phone')">
											<i class="tdsi-call-fill text-md text-white"></i>
										</span>
										<span tds-tooltip tooltipTitle="Chọn làm địa chỉ"
											class="h-5 w-5 bg-base-orange-500 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
											(click)="selectOrder('address')">
											<i class="tdsi-pin-fill text-md text-white"></i>
										</span>
										<span tds-tooltip tooltipTitle="Thêm vào ghi chú"
											class="h-5 w-5 bg-base-blue-500 flex items-center justify-center rounded-md cursor-pointer"
											(click)="selectOrder('note')">
											<i class="tdsi-note-2-fill text-md text-white"></i>
										</span>
									</div>
								</div>
							</div>
							<div class="chat-meta text-neutral-1-600 text-caption-2 font-regular mt-1.5 relative">
								<div class="chat-acts flex flex-row items-center relative" >
									<span *ngIf="child.created_time" class="date-diff cursor-pointer hover:underline"	tds-tooltip
										tooltipTitle="{{child.created_time | date:'dd'}} Tháng {{child.created_time | date:'MM'}}, {{child.created_time | date:'yyyy'}} lúc {{child.created_time | date:'HH:mm'}}">
										{{child.created_time | yiDiffDateTime}}
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!--Lọc theo comments v2 -->
	<div *ngIf="!data.comment && data.type == 2"
		class="log-comment-v2 w-full mb-3 flex {{ data.is_admin ? 'is_admin' : 'is_client' }} ">
		<div class="w-full flex flex-row">
			<!-- Avatar Facebook_PageId -->
			<div class="mr-2">
				<tpage-avatar-facebook [shape]="'circle'" [size]="36"
					[psid]="!data.is_admin ? data.from_id : team.Facebook_PageId" [token]="team?.Facebook_PageToken">
				</tpage-avatar-facebook>
			</div>
			<!--Nội dung bình luận-->
			<div class="flex flex-col w-full commnent-block">
				<!--Chat chỉ gửi hình ảnh-->
				<div *ngIf="data.Image" class="img-outer">
					<img tds-image [tdsSrc]="data.Image" class="img-responsive img-thumbnail">
				</div>
				<div class="inline-flex w-fit chat-main-block group">
					<!--Nội dung-->
					<div class="chat-body w-full !m-0" tds-tooltip
						tooltipTitle="{{data.DateCreated | date:'dd'}}/{{data.DateCreated | date:'MM'}} {{data.DateCreated | date:'HH:mm'}}">
						<div class="chat-content bg-white px-4 py-2 rounded-b-xl rounded-r-xl">
							<div *ngIf="data.message_formatted">
								<span class="text-error-400">Lỗi hiển thị bài viết</span>
								<div #contentMessage class="content-message"
									[innerHTML]="data.message_formatted | formatIconLike | safeHtml"></div>
							</div>
							<div *ngIf="!data.message_formatted">
								<div class="content-message" #contentMessage>
									{{data.message_formatted | formatIconLike | safeHtml}}
								</div>
							</div>
						</div>
					</div>
					<!-- Lỗi gửi tin -->
					<div *ngIf="data.error_message || data.status == enumActivityStatus.fail">
						<span class="tdsi-information-fill" title="{{data.error_message}}"></span>
					</div>
					<!-- Thao tác -->
					<div *ngIf="!data.message?.attachments" class="chat-option invisible group-hover:visible">
						<div class="select-order flex flex-row items-center w-fit h-full pl-3">
							<span tds-tooltip tooltipTitle="Chọn làm số điện thoại"
								class="h-5 w-5 bg-base-green-400 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
								(click)="selectOrder('phone')">
								<i class="tdsi-call-fill text-md text-white"></i>
							</span>
							<span tds-tooltip tooltipTitle="Chọn làm địa chỉ"
								class="h-5 w-5 bg-base-orange-500 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
								(click)="selectOrder('address')">
								<i class="tdsi-pin-fill text-md text-white"></i>
							</span>
							<span tds-tooltip tooltipTitle="Thêm vào ghi chú"
								class="h-5 w-5 bg-base-blue-500 flex items-center justify-center rounded-md cursor-pointer"
								(click)="selectOrder('note')">
								<i class="tdsi-note-2-fill text-md text-white"></i>
							</span>
						</div>
					</div>
				</div>
				<!--Thích hiện ẩn + CreatedBy.Name-->
				<div class="chat-meta bg-transparent text-neutral-1-600 text-caption-2 font-regular mt-1.5">
					<div class="chat-acts flex flex-row items-center" style="position: relative;">
						<span *ngIf="data.DateCreated" class="date-diff cursor-pointer hover:underline" tds-tooltip
							tooltipTitle="{{data.DateCreated | date:'dd'}} Tháng {{data.DateCreated | date:'MM'}}, {{data.DateCreated | date:'yyyy'}} lúc {{data.DateCreated | date:'HH:mm'}}">
							{{data.DateCreated | yiDiffDateTime}}
						</span>
					</div>
					<span class="chat-by font-regular" *ngIf="data.IsHandledBySystem && data.CreatedBy"> Được gửi bởi
						<span class="font-semibold" style="color: #03468b;">{{data.CreatedBy.Name}}</span>
					</span>
				</div>
				<!-- Input trả lời bình luận -->
				<div class="chat-reply relative flex flex-col gap-y-5 bg-white rounded-xl w-full p-4 mt-4 border-b-2 border-primary-1" *ngIf="isReply == true">
					<div [ngClass]="isReplyingComment?'!cursor-wait':'hidden'" class="absolute top-0 left-0 z-10 w-full h-full opacity-100">
					</div>
					<div class="flex flex-row w-full">
						<textarea id="inputReply" #contentReply tdsInput placeholder="Nhập nội dung trả lời"
                [(ngModel)]="messageModel" [ngModelOptions]="{standalone: true}"
                class="w-full resize-none !p-0 !m-0 no-scrollbar" >
            </textarea>
						<div class="">
							<button tds-button type="button" color="primary" class="!rounded-full" [size]="'lg'" (click)="onEnter($event)">
								<span class="flex items-center px-5">
									<i class="tdsi-send-fill text-lg leading-none mr-2"></i> Gửi
								</span>
							</button>
						</div>
					</div>
					<!-- Check Private Reply -->
					<div class="quick-message gap-5">
						<div class="check gap-5 flex justify-between">
							<div class="icon-send flex flex-row mr-2 gap-x-2 items-center">
								<a class="tdsi-emotion-line text-neutral-1-400 text-xl leading-none cursor-pointer p-2 hover:bg-neutral-3-50 rounded-md" 
									type="button" tds-tooltip tooltipTitle="Cảm xúc"
									tds-popover popoverTrigger="click"
									[popoverContent]="infoEmojiMart"
									[popoverAutoClose]="true"
									[popoverBackdrop]="true"
									popoverPlacement="top">
									<ng-template #infoEmojiMart>
										<div (loadEmojiMart)="loadEmojiMart($event)" icon-emoji-mart></div>
									</ng-template>
								</a>
								<div class="text-neutral-1-400 cursor-pointer p-2 rounded-md tdsi-product-line text-xl leading-none hover:bg-neutral-3-50" *ngIf="isPrivateReply"
									(onProductSelected)="onProductSelected($event)" tds-tooltip tooltipTitle="Sản phẩm">
								</div>
								<quick-reply-button class="p-2 rounded-md hover:bg-neutral-3-50" tds-tooltip tooltipTitle="Tin nhắn nhanh" (onQuickReplySelected)="onQuickReplySelected($event)"></quick-reply-button>
							</div>
							<tds-checkbox [checked]="isPrivateReply" (change)="changeIsPrivateReply()">
								Gửi về tin nhắn
							</tds-checkbox>
						</div>
					</div>
				</div>
				<!-- Phản hồi bình luận -->
				<div *ngIf="children" class="chat-list" @eventReplyComment>
					<div class="chat-item mt-4 chat-comment flex flex-row" *ngFor="let child of children; let i = index">
						<div class="avatar mr-2">
							<tpage-avatar-facebook [shape]="'circle'" [size]="36" [psid]="child.from.id"
								[token]="team?.Facebook_PageToken">
							</tpage-avatar-facebook>
						</div>
						<div class="flex flex-col w-full">
							<div class="inline-flex w-fit group">
								<div class="chat-body !m-0" tds-tooltip
									tooltipTitle="{{child.created_time | date:'dd'}}/{{child.created_time | date:'MM'}} {{child.created_time | date:'HH:mm'}}">
									<div class="chat-content flex-auto bg-white px-4 py-2 rounded-b-xl rounded-r-xl">
										<div class="border-activety-comment" *ngIf="child.message_format">
											<div class="name font-semibold pb-1">{{child.from.name}}</div>
											<div class="content-message font-regular"
												[innerHTML]="child.message_format | safeHtml"></div>
										</div>
										<div class="border-activety-comment" *ngIf="!child.message_format">
											<div class="name font-semibold pb-1">{{child.from.name}}</div>
											<div class="content-message font-regular">{{child.message}}</div>
										</div>
									</div>
								</div>
								<div *ngIf="!child.message?.attachments"
									class="chat-option invisible group-hover:visible">
									<div class="select-order flex flex-row items-center w-fit h-full pl-3">
										<span tds-tooltip tooltipTitle="Chọn làm số điện thoại"
											class="h-5 w-5 bg-base-green-400 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
											(click)="selectOrder('phone')">
											<i class="tdsi-call-fill text-md text-white"></i>
										</span>
										<span tds-tooltip tooltipTitle="Chọn làm địa chỉ"
											class="h-5 w-5 bg-base-orange-500 flex items-center justify-center rounded-md cursor-pointer mr-1.5"
											(click)="selectOrder('address')">
											<i class="tdsi-pin-fill text-md text-white"></i>
										</span>
										<span tds-tooltip tooltipTitle="Thêm vào ghi chú"
											class="h-5 w-5 bg-base-blue-500 flex items-center justify-center rounded-md cursor-pointer"
											(click)="selectOrder('note')">
											<i class="tdsi-note-2-fill text-md text-white"></i>
										</span>
									</div>
								</div>
							</div>
							<div class="chat-meta text-neutral-1-600 text-caption-2 font-regular mt-1.5"
								style="position: relative;">
								<div class="chat-acts flex flex-row items-center" style="position: relative;">
									<span *ngIf="child.created_time" class="date-diff cursor-pointer hover:underline"
										tds-tooltip
										tooltipTitle="{{child.created_time | date:'dd'}} Tháng {{child.created_time | date:'MM'}}, {{child.created_time | date:'yyyy'}} lúc {{child.created_time | date:'HH:mm'}}">
										{{child.created_time | yiDiffDateTime}}
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!----Popup send_picture lọc theo Messages---->
<ng-template #send_picture>

</ng-template>
