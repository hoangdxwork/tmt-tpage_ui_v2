<div class="flex flex-col relative pr-1 py-1 h-full w-full text-body-2 text-neutral-1-900" *ngIf="data">
    <!-- Tổng quan bài viết-->
    <div class="post-view bg-white h-auto w-full mb-1">
        <div class="flex flex-row justify-between p-2 border-b-3 border-neutral-3-200">
            <div class="flex items-center">
                <tds-avatar [icon]="data.status_type === 'added_video'? 'tdsi-video-camera-fill': 'tdsi-facebook-f-fill'"
                    [ngClass]="data.status_type === 'added_video'? 'bg-base-red-500' : 'bg-base-blue-500'" class="text-white mr-1"
                    [size]="36" [shape]="'circle'" [isAvatar]="false">
                </tds-avatar>
                <tds-tag 
                    [status]="data.status_type === 'added_video' ? 'bg-base-red-50 text-base-red-600' : 'bg-base-blue-50 text-base-blue-600'"
                    rounded="rounded-full">
                    <span class="flex flex-row items-center py-0.5">
                        <div class="font-semibold mr-3">
                            <span>{{translateType(data.type, data.status_type)}}</span>
                            {{data.created_time | date: "dd-MM-yyyy HH:mm"}}
                        </div>
                        <!-- truy cập bài viết -->
                        <a href="{{data.permalink_url}}" target="_blank" class="text-neutral-1-400 pr-1.5">
                            <i class="tdsi-expand-2-line leading-none text-xl"></i>
                        </a>
                    </span>
                </tds-tag>
            </div>
            <div class="post-option flex flex-row items-center gap-3">
                <button tds-button color="secondary">
                    <span class="flex items-center">
                        <i class="tdsi-product-fill text-lg text-neutral-1-400 leading-none mr-2"></i>Chọn sản phẩm
                    </span>
                </button>
                <!-- sort -->
                <!-- <tds-form-field>
          <tds-select valueField="value" textField="text" placeholder='Sắp xếp theo' tooltipTitle="Sắp xếp bài viết" tooltipPlacement="bottom" tds-tooltip
              [(ngModel)]="currentSort" [valuePrimitive]="false"
              [data]="sortOptions" (ngModelChange)="onChangeSort($event)">
          </tds-select>
        </tds-form-field> -->
                <button tds-button color="secondary" tds-dropdown trigger="click"
                    [tdsDropdownMenu]="menu" tooltipTitle="Thao tác excel" tooltipPlacement="bottom" tds-tooltip>
                    <span class="flex items-center">
                        <i class="tdsi-excel-fill text-2xl leading-none text-neutral-1-600"></i>
                        <i class="tdsi-arrow-down-fill text-lg leading-none ml-2 text-neutral-1-600"></i>
                    </span>
                </button>
                <tds-dropdown-menu #menu="tdsDropdownMenu">
                    <div class="w-[200px] flex flex-col gap-y-1">
                        <span tds-dropdown-item *ngFor="let item of filterExcel" (click)="onChangeFilter(item)">
                            <a>{{item.text}}</a>
                        </span>
                    </div>
                </tds-dropdown-menu>

                <!-- cài đặt-->
                <button (click)="openConfigPost()" tds-button-icon color="secondary" size="md"
                    tooltipTitle="Cấu hình bài viết" tooltipPlacement="bottom" tds-tooltip>
                    <span class="flex items-center justify-center">
                        <i class="tdsi-gear-2-fill text-neutral-1-500"></i>
                    </span>
                </button>
                <!-- cấu hình bài viết -->
                <button tds-button-icon color="secondary" size="md" tooltipTitle="Cấu hình in" tooltipPlacement="bottom"
                    tds-tooltip>
                    <span class="flex items-center justify-center">
                        <i class="tdsi-setting-print-fill text-neutral-1-500"></i>
                    </span>
                </button>
                <!-- đơn hàng -->
                <tds-badge [count]="3" [tdsClass]="'bg-error-400 text-white'" tooltipTitle="Đơn hàng"
                    tooltipPlacement="bottom" tds-tooltip>
                    <button tds-button-icon color="secondary" size="md">
                        <span class="flex items-center justify-center">
                            <i class="tdsi-bag-fill text-neutral-1-500"></i>
                        </span>
                    </button>
                </tds-badge>
                <!-- reload -->
                <button tds-button-icon color="secondary" size="md" tooltipTitle="Tải lại trang"
                    tooltipPlacement="bottom" tds-tooltip (click)="fetchComments()">
                    <span class="flex items-center justify-center">
                        <i class="tdsi-reload-fill text-neutral-1-500"></i>
                    </span>
                </button>
            </div>
        </div>
        <div class="post-block bg-white flex flex-col">
            <div class="post-body flex flex-row justify-between p-4">
                <div class="flex flex-col justify-between gap-y-3">
                    <div class="w-full flex flex-col gap-y-3">
                        <p class="text-title-1 font-semibold" *ngIf="data.story">
                            {{data.story}}
                        </p>
                        <div [innerHTML]="data.message | safeHtml"></div>
                        <p *ngIf="!data.message && !data.story" class="italic text-neutral-1-900 text-caption-1">(Chưa
                            có nội dung tiêu đề)</p>
                        <!-- <p class="description" *ngIf="data.description">{{data.description}}</p> -->
                    </div>
                    <div *ngIf="data.live_campaign">
                        <tds-tag size="sm" status="bg-base-orange-50 text-base-orange-500" >
                            <span class="flex items-center py-0.5 cursor-pointer max-w-[150px]" tds-tooltip
                                [tooltipTitle]="data.live_campaign?.name">
                                <span class="flex-auto truncate">{{data.live_campaign?.name}}</span>
                                <i class="tdsi-arrow-right-line text-lg leading-none ml-1"></i>
                            </span>
                        </tds-tag>
                    </div>
                    <div *ngIf="!data.live_campaign">
                        <tds-tag size="sm" status="bg-neutral-3-100 text-neutral-1-600">
                            <span class="flex items-center py-0.5 cursor-pointer max-w-[150px]">
                                <span class="flex-auto truncate">Chọn chiến dịch</span>
                                <i class="tdsi-arrow-right-line text-lg leading-none ml-1"></i>
                            </span>
                        </tds-tag>
                    </div>
                </div>
                <div class="post-picture" *ngIf="data.picture">
                    <img [src]="data.picture" class="rounded-xl h-[122px] object-cover" />
                </div>
            </div>
            <div class="post-footer bg-neutral-3-50 text-neutral-1-600 font-regular flex flex-row items-center justify-between py-1 px-4 gap-x-2">
                <container-element [ngSwitch]="indClickFilter">
                    <!-- lọc tất cả bình luận -->
                    <ng-container *ngSwitchCase="0">
                        <div class="emotion-count flex flex-row items-center flex-auto justify-between">
                            <div class="flex gap-x-2">
                                <div class="flex flex-row">
                                    <img src="../../../assets/imagesv2/conversation/like-circle.svg" width="20px" height="20px"
                                        class="rounded-full z-50">
                                    <img src="../../../assets/imagesv2/conversation/love-circle.svg" width="20px" height="20px"
                                        class="rounded-full z-40 -ml-2">
                                </div>
                                <span>
                                    {{data.count_reactions || 0}}
                                </span>
                            </div>
                            <div class="flex gap-x-3">
                                <span class="comment-count">
                                    {{data.count_comments || 0}} bình luận
                                </span>
                                <span class="share-count  mr-3">
                                    {{data.count_shares || 0}} lượt chia sẻ
                                </span> 
                            </div>
                        </div>
                    </ng-container>
                    <!-- lọc người dùng -->
                    <ng-container *ngSwitchCase="1">
                        <button *ngIf="!isShowFilterUser; else showFilterUser" tds-button size="sm" color="primary" rounded="!rounded-full" (click)="onShowFilterUser()">
                            <span class="flex items-center text-caption-1">
                              <i class="tdsi-success-line text-[20px] leading-none mr-2"></i>Thao tác
                            </span>
                        </button>
                        <ng-template #showFilterUser>
                            <div class="flex gap-x-3 items-center">
                                <tds-checkbox class="pr-2" (change)="onAllChecked($event)" [indeterminate]="indeterminate" [checked]="checked"></tds-checkbox>
                                <button tds-button color="primary" size="sm">
                                    <span class="flex items-center">
                                        <i class="tdsi-messenger-fill text-lg leading-none mr-2"></i>Gửi tin nhắn
                                    </span>
                                </button>
                                <button tds-button color="info" size="sm">
                                    <span class="flex items-center">
                                        <i class="tdsi-print-fill text-lg leading-none mr-2"></i>In thông tin
                                    </span>
                                </button>
                                <button tds-button color="error" size="sm" rounded="!rounded-full" (click)="onShowFilterUser()">
                                    <span class="flex items-center">
                                        <i class="tdsi-close-fill text-lg leading-none mr-2"></i>Đóng
                                    </span>
                                </button>
                            </div>
                        </ng-template>
                    </ng-container>
                </container-element>
                
                <div class="flex flex-row items-center gap-3"> 
                    <!-- filter -->                 
                    <div *ngFor="let item of filterOptions; let index = index" (click)="fillterAll(item, index)"
                        [ngClass]="indClickFilter == index ?'bg-primary-3 text-primary-1 border border-primary-1':'border border-transparent'"
                        class="h-[30px] w-[30px] rounded-md cursor-pointer" tds-tooltip [tooltipTitle]="item.text">
                        <span class="flex items-center justify-center">
                            <i class="{{item.icon}} text-xl"></i>
                        </span>
                    </div>
                    <div class="h-[30px] w-[30px] rounded-md cursor-pointer" tds-tooltip tooltipTitle="Bình luận cũ nhất">
                        <i class="tdsi-sort-arrow-down-fill text-xl text-primary-1"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Danh sách bình luận -->
    <div class="flex w-full flex-auto overflow-hidden">
        <item-post-comment [post]="data" 
        [sort]="currentSort" 
        [filter]="currentFilter"
        [isShowFilterUser]="isShowFilterUser"
        class="h-full w-full">
        </item-post-comment>
        <!-- 
        [checked]="setOfCheckedId.has(item.psid)"
        (checkedChange)="onItemChecked(item.psid, $event)" -->
    </div>
</div>
