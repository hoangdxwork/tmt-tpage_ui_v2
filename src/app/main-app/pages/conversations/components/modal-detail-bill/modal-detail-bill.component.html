<tds-spin [spinning]="isLoading">
<div *ngIf="data" class="flex flex-col gap-y-8 text-body-2 text-neutral-1-900">
    <div class="flex w-full gap-8 max-h-[250px] overflow-hidden">
        <div class="flex flex-col gap-y-4 w-1/2 max-h-full overflow-y-auto tds-custom-scroll">
            <div class="w-full flex gap-x-8"  *ngFor="let product of data.OrderLines">
                <tds-avatar [shape]="'square'" [size]="64" [tdsSrc]="product.Product?.ImageUrl" [isAvatar]="false" class="rounded-lg"> </tds-avatar>
                <div class=" flex-auto flex flex-col gap-y-4">
                    <div class="flex w-full">
                        <div class="w-1/2">
                            <span>Số lượng:</span>
                        </div>
                        <div class="w-1/2">
                            <span>{{product.ProductUOMQty}}</span>
                        </div>
                    </div>
                    <div class="flex w-full">
                        <div class="w-1/2">
                            <span>Thành tiền:</span>
                        </div>
                        <div class="w-1/2">
                            <span>{{product.PriceTotal | number: '1.0-3'}} đ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class=" flex-auto flex flex-col gap-4">
            <div class="flex">
                <div class="w-1/2">
                    <span>Phí giao hàng:</span>
                </div>
                <div class="w-1/2">
                    <span>{{data.DeliveryPrice | number: '1.0-3'}} đ</span>
                </div>
            </div>
            <div class="flex">
                <div class="w-1/2">
                    <span>Tiền khách phải trả</span>
                </div>
                <div class="w-1/2">
                    <span>{{data.AmountTotal | number: '1.0-3'}} đ</span>
                </div>
            </div>
            <div class="flex text-title-1 font-semibold">
                <div class="w-1/2">
                    <span>Tổng tiền:</span>
                </div>
                <div class="w-1/2">
                    <span>{{data.CashOnDelivery | number: '1.0-3'}} đ</span>
                </div>
            </div>
        </div>
    </div>
    <div class="flex flex-col gap-y-4">
        <div>
            <span class="text-header-2 font-semibold text-neutral-1-600">Thông tin xác nhận</span>
        </div>
        <div class="w-full bg-neutral-3-50 rounded-xl flex items-center p-4">
            <div class="grid flex-auto grid-cols-2 gap-4">
                <div class="flex gap-x-2">
                    <span class="flex flex-none">
                        <i class="tdsi-user-fill mr-1 text-neutral-1-500 text-xl leading-none"></i>
                        <span class="font-semibold">Người nhận hàng:</span>
                    </span>
                    <span>{{data.Ship_Receiver? data.Ship_Receiver.Name: '...'}}</span>
                </div>
                <div class="flex gap-x-2">
                    <span class="flex flex-none">
                        <i class="tdsi-call-fill mr-1 text-neutral-1-500 text-xl leading-none"></i>
                        <span class="font-semibold">Số điện thoại:</span> 
                    </span>
                    <span>{{data.Ship_Receiver? data.Ship_Receiver.Phone : '...'}}</span>
                </div>
                <div class="flex gap-x-2">
                    <span class="flex flex-none">
                        <i class="tdsi-pin-fill mr-1 text-neutral-1-500 text-xl leading-none"></i>
                        <span class="font-semibold">Địa chỉ giao hàng: </span>
                    </span>
                    <span>{{addressShip}}</span>
                </div>
                <div class="flex gap-x-2">
                    <span class="flex flex-none">
                        <i class="tdsi-edit-paper-fill mr-1 text-neutral-1-500 text-xl leading-none"></i>
                        <span class="font-semibold">Ghi chú đơn hàng:</span>
                    </span>
                    <span>{{data.DeliveryNote || ''}}</span>
                </div>
            </div>
            <div>
                <button tds-flat-button size="md" (click)="showModalConfirmShippingAddress(data)">
                    <span class="flex items-center text-primary-1 truncate">
                        <i class=" tdsi-edit-fill text-xl leading-none mr-2">
                        </i>Chỉnh sửa
                    </span>
                </button>
            </div>
        </div>
        <div class="w-full bg-neutral-3-50 rounded-xl flex items-center p-4">
            <div class="flex-auto">
                <span class="flex items-center gap-x-1">
                    <i class="tdsi-user-fill text-neutral-1-500 text-xl leading-none"></i>
                    <span class="font-semibold">Xác nhận thanh toán:</span> 
                    <span *ngIf="!data.PaymentMethod" class="text-error-500">Chưa chọn</span>
                    <span *ngIf="data.PaymentMethod" class="text-info-500">{{data.PaymentMethod}}</span>
                    <span>{{data.CashOnDelivery | number:'1.0-3'}} đ</span>
                </span>
            </div>
            <div>
                <button tds-flat-button size="md" (click)="showModalConfirmPayment(data)">
                    <span class="flex items-center text-primary-1">
                        <i class=" tdsi-edit-fill text-xl leading-none mr-2">
                        </i>Chỉnh sửa
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>
</tds-spin>
<div class="w-full flex justify-end p-4" *tdsModalFooter>
    <button tds-button class="mr-2" color="secondary" (click)="cancel()">Đóng</button>
    <button tds-button class="mr-2" color="primary" (click)="onSave()">Xác nhận</button>
</div>