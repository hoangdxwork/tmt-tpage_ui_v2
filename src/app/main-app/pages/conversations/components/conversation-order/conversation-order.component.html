<tds-spin [spinning]="isLoading" class="w-full h-[calc(100vh-109px)] flex z-50 desktop:text-body-2 laptop:text-caption-1 text-caption-1">
    <div *ngIf="quickOrderModel">
        <div class="w-full h-[calc(100vh-109px)] flex flex-col bg-neutral-3-100 overflow-y-auto tds-custom-scroll desktop:text-body-2 laptop:text-caption-1 text-caption-1">
            <!-- Thông tin khách hàng -->
            <tds-collapse [expandIconPosition]="'right'" class="bg-white collapse-content-bg-white">
                <tds-collapse-panel [header]="headerOrder" [tdsHeaderClass]="'desktop:px-4 laptop:px-3 px-3 desktop:py-3 laptop:py-2 py-2'"
                    [tdsClass]="'desktop:px-4 laptop:px-3 px-3 desktop:py-4 laptop:py-2 py-2'"
                    [active]="true" [disabled]=false [expandedIcon]="'tdsi-arrow-up-line'">
                    <div class="flex flex-col desktop:gap-3 laptop:gap-1 gap-1 desktop:p-2 desktop:text-body-2 laptop:text-caption-1 text-caption-1">
                        <!-- partner name -->
                        <div class="flex gap-2 items-center">
                            <div class="tdsi-user-fill px-1 bg-neutral-3-50 text-neutral-1-400 text-xl rounded-[10px]"></div>

                            <div class="flex flex-auto items-center justify-between">
                                <div class="flex gap-4 items-center desktop:w-[70%] laptop:w-[90%] desktop:justify-between">
                                    <span *ngIf="!isEditPartner" class="max-w-[50%] truncate"
                                        tds-tooltip="{{quickOrderModel.PartnerName}}">{{ quickOrderModel.PartnerName }}</span>
                                    <tds-form-field *ngIf="isEditPartner">
                                        <input tdsInput autocomplete="off" placeholder="Tên khách hàng" [required]='true'
                                            [size]="reponsiveDesktop ? 'md' : 'sm'"
                                            [(ngModel)]="quickOrderModel.PartnerName" [ngModelOptions]="{ standalone: true }"
                                            class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"/>
                                    </tds-form-field>

                                    <div *ngIf="team?.Type === 'Facebook'" class="max-w-[50%] truncate">
                                        <span class="text-primary-1 font-semibold"
                                            tds-tooltip="{{quickOrderModel.Facebook_UserName}}">FB: {{ quickOrderModel.Facebook_UserName }}</span>
                                    </div>

                                    <div *ngIf="team?.Type === 'TShop'" class="max-w-[50%] truncate">
                                        <span class="text-primary-1 font-semibold"
                                            tds-tooltip="{{quickOrderModel.Facebook_UserName}}">TShop: {{ quickOrderModel.Facebook_UserName }}</span>
                                    </div>

                                    <div *ngIf="team?.Type === 'UnofficialTikTok'" class="max-w-[50%] truncate">
                                        <span class="text-primary-1 font-semibold"
                                            tds-tooltip="{{quickOrderModel.Facebook_UserName}}">TikTok: {{ quickOrderModel.Facebook_UserName }}</span>
                                    </div>
                                </div>

                                <button type="button" tds-button-icon color="secondary" [size]="reponsiveDesktop ? 'md' : 'sm'" (click)="onEditPartner()" tds-tooltip tooltipPlacement="topRight" [tooltipTitle]="isEditPartner ? 'Đóng' : 'Chỉnh sửa'" >
                                    <span class="flex items-center">
                                        <i [ngClass]="isEditPartner? 'tdsi-close-fill': 'tdsi-edit-fill'" class="desktop:text-xl laptop:text-lg text-lg desktop:leading-none laptop:leading-3 leading-3 text-neutral-1-400"></i>
                                    </span>
                                </button>
                            </div>
                        </div>

                        <!-- telephone -->
                        <div class="flex gap-2 items-center">
                            <div class="tdsi-call-fill px-1 bg-neutral-3-50 text-neutral-1-400 text-xl rounded-[10px]"></div>
                            <span *ngIf="!isEditPartner" class="text-neutral-1-900 font-regular font-sans desktop:text-body-2 laptop:text-caption-1 text-caption-1">
                                {{ quickOrderModel.Telephone || 'Không có số điện thoại' }}
                            </span>

                            <tds-form-field *ngIf="isEditPartner" class="flex flex-auto">
                                <input tdsInput placeholder="Số điện thoại"
                                    class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    [(ngModel)]="quickOrderModel.Telephone" [ngModelOptions]="{ standalone: true }" [required]='true'/>
                            </tds-form-field>
                        </div>

                        <!-- email -->
                        <div class="flex gap-2 items-center">
                            <div class="tdsi-email-fill px-1 bg-neutral-3-50 text-neutral-1-400 text-xl rounded-[10px]"></div>
                            <span *ngIf="!isEditPartner" class="text-neutral-1-900 font-regular font-sans desktop:text-body-2 laptop:text-caption-1 text-caption-1">{{ quickOrderModel.Email || 'Chưa có Email' }}</span>

                            <tds-form-field *ngIf="isEditPartner" class="flex flex-auto">
                                <input tdsInput autocomplete="off" placeholder="Email"
                                    class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    [(ngModel)]="quickOrderModel.Email" [ngModelOptions]="{ standalone: true }"/>
                            </tds-form-field>
                        </div>

                        <!-- địa chỉ -->
                        <div class="flex gap-2 items-center">
                            <div class="tdsi-pin-fill p-1 bg-neutral-3-50 text-neutral-1-400 text-xl leading-none rounded-[10px]"></div>
                            <span *ngIf="!isEditPartner" class="text-neutral-1-900 font-regular font-sans desktop:text-body-2 laptop:text-caption-1 text-caption-1">{{ quickOrderModel.Address || 'Chưa có địa chỉ' }}</span>

                            <div *ngIf="isEditPartner" class="w-full flex gap-x-2">
                                <!-- <tds-form-field *ngIf="isEditPartner" class="flex flex-auto">
                                    <input tdsInput autocomplete="off" placeholder="Địa chỉ"
                                        class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                        [size]="reponsiveDesktop ? 'md' : 'sm'"
                                        [(ngModel)]="quickOrderModel.Address" [ngModelOptions]="{ standalone: true }"/>
                                </tds-form-field> -->

                                <tds-select valueField="Address" textField="Address"
                                    placeholder='Nhập địa chỉ cần tìm' disabledField="isActive"
                                    [data]="suggestData | async" [allowClear]="true" [valuePrimitive]="false"
                                    [autoClearSearchValue]="true" [serverSearch]="true" 
                                    [(ngModel)]="suggestText" [ngModelOptions]="{standalone: true}"
                                    [tdsInputDebounce]="300" 
                                    (inputKeyup)="onInputKeyupSuggestion($event)"
                                    (onSearch)="onSearchSuggestion($event)" 
                                    (selectChange)="onSelectSuggestion($event)">

                                    <ng-template tds-option-tmp let-label='label' let-item="item" let-value='value' let-selected="selected">
                                        <a [ngClass]="{'text-primary-1':selected}"> {{item.Address}} </a>
                                    </ng-template>
                                </tds-select>
                                <button tds-button-icon color="primary" (click)="showModalSuggestAddress()" tds-tooltip tooltipPlacement="topRight" [tooltipTitle]="quickOrderModel.Address ? 'Kiểm tra địa chỉ' : 'Tìm kiếm địa chỉ'">
                                    <span class="flex items-center">
                                      <i class="tdsi-location-fill"></i>
                                    </span>
                                </button>
                            </div>
                        </div>

                        <!-- Suggest -->
                        <div *ngIf="isSuggestion" class="flex flex-col overflow-hidden">
                          <div class="w-full flex mb-2">
                            <tds-form-field class="w-full">
                              <tds-select valueField="code" textField="name" placeholder='Tỉnh/Thành' [valuePrimitive]="false"
                                (onSearch)="handleCityFilter($event)" [(ngModel)]="_cities" [ngModelOptions]="{standalone: true}"
                                disabledField="isActive" [data]="lstCity"
                                [allowClear]="true" (selectChange)="changeCity($event)">
                              </tds-select>
                            </tds-form-field>
                          </div>
                          <div class="w-full flex mb-2">
                            <tds-form-field class="w-full">
                              <tds-select valueField="code" textField="name" placeholder='Quận/Huyện' [valuePrimitive]="false"
                                (onSearch)="handleFilterDistrict($event)" [(ngModel)]="_districts" [ngModelOptions]="{standalone: true}"
                                disabledField="isActive" [data]="lstDistrict" [allowClear]="true" (selectChange)="changeDistrict($event)">
                              </tds-select>
                            </tds-form-field>
                          </div>
                          <div class="w-full flex mb-2">
                            <tds-form-field class="w-full">
                              <tds-select valueField="code" textField="name" placeholder='Phường/Xã' [valuePrimitive]="false"
                                (onSearch)="handleFilterWard($event)" [(ngModel)]="_wards" [ngModelOptions]="{standalone: true}"
                                disabledField="isActive" [data]="lstWard"
                                [allowClear]="true" (selectChange)="changeWard($event)">
                              </tds-select>
                            </tds-form-field>
                          </div>
                          <div class="w-full flex">
                            <tds-form-field class="w-full">
                                <input tdsInput autocomplete="off" class="w-full truncate" placeholder="Địa chỉ" [(ngModel)]="quickOrderModel.Address" [ngModelOptions]="{standalone: true}"/>
                            </tds-form-field>
                          </div>
                        </div>
                    </div>

                    <div class="w-full desktop:pt-4 laptop:pt-1 pt-1 flex items-stretch bg-white">
                        <textarea tdsInput placeholder="Ghi chú"
                            class="resize-none no-scrollbar desktop:w-3/4 laptop:w-2/3 desktop:mx-2 px-3 py-2 rounded-xl !bg-neutral-3-50 desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                            [(ngModel)]="quickOrderModel.Note" (change)="changeNote($event)"></textarea>

                        <button tds-button-flat-icon color="secondary" tds-dropdown trigger="click" [placement]="'bottomRight'" [autoClose]="true" [backdrop]="true" [tdsDropdownMenu]="menuUser"
                            class="desktop:w-1/4 laptop:w-1/3 !h-full flex items-center mx-2 my-1.5 desktop:px-3 desktop:py-2 laptop:p-2 rounded-xl !bg-neutral-3-50">
                            <div class="flex flex-col flex-auto items-start">
                                <label class="text-neutral-1-400 font-regular desktop:text-body-2 laptop:text-caption-1 text-caption-1">Nhân viên</label>
                                <span class="text-info-500 font-semibold desktop:text-body-2 laptop:text-caption-1 text-caption-1 desktop:max-w-[100px] laptop:max-w-[80px] truncate">{{ quickOrderModel?.User?.Name || 'N/A' }}</span>
                            </div>

                            <i class="tdsi-arrow-down-line desktop:w-1/5 laptop:w-1/6"></i>

                            <tds-dropdown-menu #menuUser="tdsDropdownMenu">
                                <div class="desktop:w-72 laptop:w-60 w-60 max-h-80 overflow-hidden overflow-y-auto tds-panel-scroll ">
                                    <div class="desktop:px-4 laptop:px-2 px-2 desktop:py-2 laptop:py-1 py-1">
                                        <tds-form-field class="w-full">
                                            <input tdsInput placeholder="Tìm kiếm" autocomplete="off" [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                                [(ngModel)]="keyFilterUser" [ngModelOptions]="{standalone: true}"
                                                [tdsInputDebounce]="750" (inputKeyup)="searchUser()"/>
                                            <span tdsPrefix><i class="text-neutral-1-500 tdsi-search-fill desktop:text-body-2 laptop:text-caption-1 text-caption-1"></i></span>
                                        </tds-form-field>
                                    </div>
                                    <div class="desktop:gap-y-2 laptop:gap-y-1 gap-y-1 flex flex-col overflow-y-auto tds-panel-scroll">
                                        <div *ngFor="let item of lstUser" (click)="changeUser(item)"
                                        class="desktop:py-2 laptop:py-1 py-1 desktop:px-3 laptop:px-2 px-2 rounded-full cursor-pointer hover:bg-neutral-3-50 flex justify-between items-center" >
                                        <div class="flex gap-x-2">
                                            <span *ngIf="item?.Avatar">
                                              <tds-avatar [size]="24" [tdsSrc]="item.Avatar" *ngIf="reponsiveDesktop"></tds-avatar>
                                              <tds-avatar [size]="20" [tdsSrc]="item.Avatar" *ngIf="!reponsiveDesktop"></tds-avatar>
                                            </span>
                                            <span *ngIf="!item?.Avatar">
                                                <tds-avatar [text]="item.Name | avatarRandom" class="text-white" [size]="24"
                                                    [style.background-color]="item.Id | randomColor" *ngIf="reponsiveDesktop"></tds-avatar>
                                                <tds-avatar [text]="item.Name | avatarRandom" class="text-white" [size]="20"
                                                    [style.background-color]="item.Id | randomColor" *ngIf="!reponsiveDesktop"></tds-avatar>
                                            </span>
                                            <span class="desktop:text-body-2 laptop:text-caption-1 text-caption-1 self-center">{{item.Name}}</span>
                                        </div>
                                        <span class="tdsi-success-fill text-success-500 desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                            *ngIf="item.Id == quickOrderModel?.User?.Id"></span>
                                        </div>
                                    </div>
                                    <!-- <div class="flex justify-center items-center text-caption-1 text-error-400 border-t border-neutral-2-100">
                                        <span class="cursor-pointer pt-2 flex items-center" (click)="assignUser()">
                                            <i class="tdsi-error-line leading-none mr-2"></i>Bỏ gán nhân viên
                                        </span>
                                    </div> -->
                                </div>
                            </tds-dropdown-menu>
                        </button>
                    </div>
                </tds-collapse-panel>

                <ng-template #headerOrder>
                    <div class="desktop:!text-header-1 laptop:!text-title-1 !text-title-1 font-semibold">
                        Thông tin khách hàng
                    </div>
                </ng-template>
            </tds-collapse>

            <!-- Sản phẩm -->
            <tds-collapse [expandIconPosition]="'right'" class="bg-white collapse-content-bg-white desktop:mt-1 laptop:mt-0.5 mt-0.5">
                <tds-collapse-panel [header]="headerProduct" [tdsHeaderClass]="'desktop:px-4 laptop:px-3 px-3 desktop:py-3 laptop:py-2 py-2'"
                    [tdsClass]="'p-0'"
                    [active]="true" [disabled]=false [expandedIcon]="'tdsi-arrow-up-line'">

                    <div class="flex desktop:gap-1.5 laptop:gap-1 gap-1 desktop:px-4 laptop:px-3 px-3 desktop:pt-6 laptop:pt-3 pt-3 desktop:pb-3 laptop:pb-1.5 pb-1.5">
                        <div class="w-full">
                            <div class="relative flex-auto">
                                <tds-form-field class="w-full">
                                    <input tdsInput placeholder="Tìm kiếm sản phẩm" autocomplete="off" [tdsInputDebounce]="750"
                                        class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                        [size]="reponsiveDesktop ? 'md' : 'sm'"
                                        [(ngModel)]="textSearchProduct" [ngModelOptions]="{standalone: true}" (inputKeyup)="onSearchProduct($event)">

                                    <span tdsPrefix><i class="text-neutral-1-500 tdsi-search-fill desktop:text-body-2 laptop:text-caption-1 text-caption-1"></i></span>

                                    <span *ngIf="textSearchProduct" tdsSuffix>
                                        <i class="text-neutral-1-500 tdsi-close-fill desktop:text-body-2 laptop:text-caption-1 text-caption-1 mr-2" (click)="closeSearchProduct()" ></i>
                                    </span>

                                    <span tdsSuffix class="cursor-pointer" title="Chọn sản phẩm" (click)="showModalListProduct()">
                                        <i class="text-neutral-1-500 tdsi-product-line"></i>
                                    </span>
                                </tds-form-field>

                                <div *ngIf="textSearchProduct && indexDbStorage && indexDbStorage.length > 0; else noDataProduct"
                                    class="absolute left-0 right-0 -bottom-2 top-full h-[300px] z-10 bg-white shadow-md">
                                    <tds-table #basicTable [listData]="indexDbStorage | filterindexdblive: innerTextDebounce"
                                        [scroll]="{ y:'100%', x:'hidden' }" [showPagination]="false"
                                        [frontPagination]="false" [virtualItemSize]="20"
                                        [loading]="isLoadingProduct" [virtualForTrackBy]="trackByIndex">
                                        <tbody>
                                            <ng-template tds-virtual-scroll let-data let-index="index">
                                                <tr *ngIf="data" (click)="selectProduct(data)"
                                                    class="group hover:cursor-pointer">
                                                    <td>
                                                        <span class="desktop:text-body-2 laptop:text-caption-1 text-caption-1 w-full truncate" tds-tooltip tooltipTitle="{{ data.NameGet }}">
                                                            <span>{{ data.NameGet }}</span> - <span class="text-primary-1">{{ data.Price | numberCustom }} đ</span>
                                                        </span>
                                                        <div class="w-full flex gap-x-2">
                                                            <span class="text-neutral-1-400 font-regular text-[13px] flex gap-x-2 items-center"> Tồn kho:
                                                                <span class="text-primary-1" *ngIf="lstInventory">{{lstInventory[data.Id]? lstInventory[data.Id].QtyAvailable : 0}}</span>
                                                                <tds-spinner [color]="'primary'" class="w-2.5 h-2.5"
                                                                    *ngIf="!lstInventory"></tds-spinner>
                                                            </span>
                                                            <span class="ml-1 mr-1"> / </span>
                                                            <span class="text-neutral-1-400 font-regular text-[13px] flex gap-x-2 items-center"> Tồn dự báo:
                                                                <span class="text-primary-1" *ngIf="lstInventory">{{lstInventory[data.Id]? lstInventory[data.Id].VirtualAvailable : 0}}</span>
                                                                <tds-spinner [color]="'primary'" class="w-2.5 h-2.5"
                                                                    *ngIf="!lstInventory"></tds-spinner>
                                                            </span>
                                                        </div>
                                                    </td>
                                                </tr>

                                            </ng-template>
                                        </tbody>
                                    </tds-table>
                                </div>

                                <ng-template #noDataProduct>
                                    <div *ngIf="textSearchProduct" class="absolute left-0 right-0 -bottom-2 top-full h-44 overflow-hidden z-10 bg-white shadow-md">
                                        <tds-spin [spinning]="isLoadingProduct">
                                            <tds-empty></tds-empty>
                                        </tds-spin>
                                    </div>
                                </ng-template>
                            </div>
                        </div>
                        <button tds-button-flat-icon type="button" color="secondary" class="cursor-pointer"
                            tds-tooltip tooltipTitle="Thêm sản phẩm" (click)="showModalAddProduct()">
                            <span class="flex items-center"> <i class="tdsi-add-fill text-primary-1"></i></span>
                        </button>
                        <!-- <button tds-button-flat-icon type="button" color="secondary" class="cursor-pointer"
                            tds-tooltip tooltipTitle="Khuyến mãi" (click)="showModalAddPromotion()">
                            <span class="flex items-center"><i class="tdsi-gift-fill text-primary-1"></i></span>
                        </button> -->
                        <button tds-button-flat-icon type="button" color="secondary" class="cursor-pointer"
                            tds-tooltip tooltipTitle="Chọn bảng giá" tooltipPlacement="topRight" (click)="showModalConfigProduct()">
                            <span class="flex items-center"><i class="tdsi-adjustments-line text-neutral-1-400"></i></span>
                        </button>
                    </div>

                    <div class="max-h-[270px] overflow-y-auto tds-panel-scroll w-full desktop:px-3 laptop:px-2 px-2">
                        <tds-table #basicTable class="w-full h-full" [listData]="quickOrderModel.Details" [showPagination]="false" [noResult]="emptyData" [frontPagination]="false">
                            <tbody>
                                <tr class="bg-white editable-row" *ngFor="let item of quickOrderModel.Details; let index = index">
                                    <!-- Sản phẩm -->
                                    <td width="60%">
                                        <div class="flex desktop:gap-3.5 laptop:gap-1.5 gap-1.5 desktop:px-4 laptop:px-3 px-3 desktop:py-4 laptop:py-1.5 py-1.5">
                                            <tds-avatar size="xl" [isAvatar]="false" [shape]="'square'" class="bg-white h-[58px] w-[58px]" [tdsSrc]="item.ImageUrl">
                                            </tds-avatar>

                                            <div class="flex flex-col gap-y-0.5 w-2/3">
                                                <p tds-tooltip="{{ item.ProductNameGet }}"
                                                    class="font-semibold desktop:text-body-2 laptop:text-caption-1 text-caption-1 truncate desktop:max-w-[200px] laptop:max-w-[150px] max-w-[100px]">
                                                    {{ item.ProductNameGet }}</p>

                                                <!-- giá bán -->
                                                <div class="text-neutral-1-400 flex items-center gap-x-2">
                                                    <span class="text-[13px] flex">
                                                        <span *ngIf="item.UOMName" class="text-[13px] flex"> {{ item.UOMName }} -&nbsp;</span>
                                                        {{ item.Price | numberCustom }}đ
                                                    </span>

                                                    <span class="tdsi-edit-line flex text-base cursor-pointer mr-1" [tds-tooltip]="'Thêm ghi chú'" tds-popover [popoverVisible]="visibleIndex == index"
                                                        popoverTrigger="click" [popoverContent]="tmpEditPrice" [popoverAutoClose]="true" [popoverBackdrop]="true"
                                                        (popoverVisibleChange)="openPopover($event, item.Price, index)">
                                                    </span>

                                                    <!-- <span *ngIf="item.Discount > 0 && isEnableCreateOrder" class="text-caption-1 text-primary-1 flex justify-center items-center font-semibold">
                                                        <i class="tdsi-tag-fill mr-1"></i> {{item.Discount}}%
                                                    </span> -->

                                                    <ng-template #tmpEditPrice>
                                                        <div class="w-[336px] flex flex-col desktop:gap-y-4 laptop:gap-y-2 gap-y-2" *ngIf="item">
                                                            <div class="flex gap-x-4 items-center">
                                                                <span class="w-1/3 desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1 font-semibold">Đơn giá</span>

                                                                <tds-form-field class="w-2/3">
                                                                    <tds-input-number autocomplete="off" placeholder="0"
                                                                        class="desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1"
                                                                        [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                                        [min]="0" [step]="1000"
                                                                        [formatter]="numberWithCommas" [parser]="parserComas"
                                                                        [(ngModel)]="priceValue" [ngModelOptions]="{standalone: true}">
                                                                    </tds-input-number>
                                                                </tds-form-field>
                                                            </div>

                                                            <!-- <div class="flex gap-x-4 items-center">
                                                                <tds-label class="w-1/3">Giảm giá</tds-label>

                                                                <tds-form-field class="w-2/3">
                                                                    <tds-input-number autocomplete="off" placeholder="0" [min]="0" [step]="1" [max]="100"
                                                                        [formatter]="numberWithCommas" [parser]="parserComas" [disabled]="true">
                                                                    </tds-input-number>
                                                                    <span tdsSuffix>
                                                                        <span class="font-semibold text-body-2 font-sans text-primary-1">%</span>
                                                                        <span class="font-semibold text-body-2 font-sans text-neutral-1-400 pl-2">VNĐ</span>
                                                                    </span>
                                                                </tds-form-field>
                                                            </div> -->

                                                            <div class="flex gap-x-2 mt-4 justify-end desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1">
                                                                <button class="min-w-[89px]" type="button" tds-button color="secondary" size="sm" (click)="closePriceDetail()">Hủy bỏ</button>
                                                                <button class="min-w-[89px]" type="button" tds-button color="primary" size="sm" (click)="approvePrice(item, index)">Áp dụng</button>
                                                            </div>
                                                        </div>
                                                    </ng-template>
                                                </div>

                                                <!-- ghi chú -->
                                                <span class="cursor-pointer desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                                    [ngClass]="item.Note? 'text-neutral-1-600 rounded-full bg-neutral-3-50 px-2' : 'text-info-500'" tds-popover popoverTrigger="click" [popoverContent]="popoverAddNote"
                                                    [popoverAutoClose]="true" [popoverBackdrop]="true" popoverPlacement="left" showMore [length]="15" [text]="item.Note || 'Ghi chú'">
                                                </span>

                                                <ng-template #popoverAddNote>
                                                    <div class="mb-2">
                                                        <tds-form-field>
                                                            <input tdsInput autocomplete="off" placeholder="Ghi chú"
                                                                class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                                                [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                                [(ngModel)]="item.Note" [ngModelOptions]="{standalone: true}"/>
                                                        </tds-form-field>
                                                    </div>
                                                </ng-template>
                                            </div>
                                        </div>
                                    </td>

                                    <!-- Số lượng -->
                                    <td width="30%">
                                        <div class="flex items-center desktop:gap-2 laptop:gap-1.5 gap-1.5 desktop:px-4 laptop:px-3 px-3 desktop:py-4 laptop:py-1.5 py-1.5">
                                            <button type="button" class="tdsi-minus-fill text-white p-0.5 bg-neutral-1-200 rounded-full cursor-pointer hover:bg-primary-1"
                                                [disabled]="item.Quantity == 1" (click)="minus(item, index)" [tds-tooltip]="'Giảm sản phẩm'"></button>
                                            <tds-form-field class="w-[50px] hover:bg-primary-1 bg-opacity-10 rounded">
                                                <input tdsInput type="number" [min]="1" [step]="1" autocomplete="off" size="sm"
                                                    class="cart-checkout text-center font-semibold text-neutral-1-900"
                                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                    placeholder="1" [ngModel]="item.Quantity" [ngModelOptions]="{standalone: true}"
                                                    (ngModelChange)="onChangeQuantity($event, item)"/>
                                            </tds-form-field>
                                            <button type="button" class="tdsi-plus-fill text-white p-0.5 bg-neutral-1-200 rounded-full hover:bg-primary-1" tds-tooltip="Tăng sản phẩm"
                                                (click)="plus(item, index)"></button>
                                        </div>
                                    </td>

                                    <!-- Xóa sản phẩm -->
                                    <td class="text-center h-full">
                                        <button type="button" (click)="onRemoveProduct(item)">
                                            <i class="tdsi-trash-line text-error-500 text-xl cursor-pointer" tds-tooltip="Xóa sản phẩm" tooltipPlacement="topRight"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </tds-table>
                        <ng-template #emptyData>
                            <div class="py-3 px-6 flex-auto desktop:text-body-2 laptop:text-caption-1 text-caption-1">
                                <div class="flex flex-col gap-4 p-4 items-center bg-white h-full">
                                    <img src="../../../assets/imagesv2/shop-empty.svg" alt="" class="w-[110px] h-[82px]">
                                    <span class="text-neutral-1-400 font-normal">Chưa có sản phẩm nào</span>
                                </div>
                            </div>
                        </ng-template>
                    </div>

                    <div class="w-ful h-full desktop:px-4 laptop:px-3 px-3 desktop:py-4 laptop:py-1.5 py-1.5 desktop:text-body-2 laptop:text-caption-1 text-caption-1" *ngIf="!isEnableCreateOrder && quickOrderModel.Details && quickOrderModel.Details.length > 0">
                        <div class="bg-neutral-2-50 flex justify-between rounded-xl desktop:p-4 laptop:p-3 p-3">
                            <label>Tổng</label>
                            <span class="col-span-2 text-right">{{ quickOrderModel.TotalAmount || 0 | numberCustom }}</span>
                        </div>
                    </div>

                    <!-- Tổng số lượng và tổng tiền -->
                    <div class="w-ful h-full desktop:p-4 laptop:p-3 p-3 desktop:text-body-2 laptop:text-caption-1 text-caption-1" *ngIf="isEnableCreateOrder && saleModel">
                        <div class="bg-neutral-2-50 rounded-xl grid desktop:grid-cols-6 laptop:grid-cols-3 grid-cols-3 desktop:gap-y-4 laptop:gap-y-2 gap-y-2 gap-x-6 p-4 items-center">

                            <label>Tổng</label>
                            <span class="col-span-2 text-right">{{ quickOrderModel.TotalAmount || 0 | numberCustom }}</span>

                            <label class="font-semibold">Tổng tiền</label>
                            <span class="desktop:text-header-1 laptop:text-title-1 text-title-1 font-semibold col-span-2 text-right">{{ saleModel.AmountTotal | numberCustom }}</span>

                            <label *ngIf="saleConfig?.SaleSetting?.GroupDiscountTotal">Giảm giá</label>
                            <div *ngIf="saleConfig?.SaleSetting?.GroupDiscountTotal" class="bg-white col-span-2 inline-flex rounded border border-neutral-2-200 pl-3">
                                <span class="flex flex-auto items-center h-8">{{saleModel.DecreaseAmount + saleModel.DiscountAmount || 0 | numberCustom}}</span>

                                <span class="flex items-center justify-center h-8 w-8"
                                    tds-popover popoverTrigger="click" [popoverContent]="tmpDiscount" [popoverAutoClose]="true" [popoverBackdrop]="true">
                                    <i class="tdsi-discount-fill text-primary-1 hover:opacity-70 desktop:text-xl laptop:text-lg text-lg cursor-pointer"></i>
                                </span>

                                <ng-template #tmpDiscount>
                                    <div class="flex flex-col gap-y-2">
                                        <div class="flex items-center">
                                            <span class="w-[35%] desktop:text-body-2 laptop:text-caption-1 text-caption-1 font-semibold">Chiếc khấu (%) </span>

                                            <tds-form-field class="w-[35%]">
                                                <tds-input-number autocomplete="off"  [min]="0" [max]="100" [step]="1"
                                                    class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                    (ngModelChange)="changeDiscount($event)" [(ngModel)]="saleModel.Discount" [ngModelOptions]="{standalone: true}">
                                                </tds-input-number>
                                                <span tdsSuffix><span class="font-semibold font-sans text-primary-1 desktop:text-body-2 laptop:text-caption-1 text-caption-1">%</span></span>
                                            </tds-form-field>

                                            <div class="w-[30%] flex justify-end text-primary-1 font-semibold desktop:text-body-2 laptop:text-caption-1 text-caption-1">
                                                <span> -{{ saleModel.DiscountAmount | numberCustom }}đ </span>
                                            </div>
                                        </div>

                                        <div class="flex items-center">
                                            <span class="w-[35%] desktop:text-body-2 laptop:text-caption-1 text-caption-1 font-semibold">Giảm tiền</span>
                                            <tds-form-field class="w-[35%]">
                                                <tds-input-number autocomplete="off" placeholder="0" [min]="0" [step]="1000"
                                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                    class="desktop:text-body-2 laptop:text-caption-1 text-caption-1"
                                                    (ngModelChange)="changeDecreaseAmount($event)" [(ngModel)]="saleModel.DecreaseAmount" [ngModelOptions]="{standalone: true}">
                                                </tds-input-number>
                                            </tds-form-field>

                                            <div class="w-[30%] flex justify-end text-primary-1 font-semibold desktop:text-body-2 laptop:text-caption-1 text-caption-1">
                                                <span> -{{ saleModel.DecreaseAmount | numberCustom }}đ </span>
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                            </div>

                            <label>Tiền cọc</label>
                            <tds-form-field class="col-span-2">
                                <tds-input-number [min]="0" [step]="1000" autocomplete="off" placeholder="0" [formatter]="numberWithCommas" [parser]="parserComas"
                                    [classList]="'desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1'"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    (ngModelChange)="changeAmountDeposit($event)" [(ngModel)]="saleModel.AmountDeposit" [ngModelOptions]="{standalone: true}">
                                </tds-input-number>
                            </tds-form-field>

                            <label *ngIf="saleConfig?.SaleSetting?.GroupFastSaleTax">Thuế</label>
                            <div *ngIf="saleConfig?.SaleSetting?.GroupFastSaleTax" class="bg-white col-span-2 inline-flex rounded border border-neutral-2-200 pl-3">
                                <span class="flex flex-auto items-center h-8">{{ saleModel.Tax?.Amount || 0 | numberCustom }}</span>

                                <span  class="flex items-center justify-center h-8 w-8">
                                    <i class="tdsi-revenue-fill text-primary-1 hover:opacity-70 desktop:text-xl laptop:text-lg text-lg cursor-pointer" (click)="showModalTax()"></i>
                                </span>
                            </div>

                            <label>Thanh toán</label>
                            <tds-form-field class="col-span-2">
                                <tds-input-number [min]="0" [step]="1000" autocomplete="off" placeholder="0" [required]='true' [formatter]="numberWithCommas" [parser]="parserComas"
                                    [classList]="'desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1'"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    [(ngModel)]="saleModel.PaymentAmount" [ngModelOptions]="{standalone: true}" [max]="saleModel.AmountTotal">
                                </tds-input-number>
                            </tds-form-field>
                        </div>
                    </div>
                </tds-collapse-panel>

                <ng-template #headerProduct>
                    <div class="desktop:!text-header-1 laptop:!text-title-1 !text-title-1 font-semibold mr-2">
                        Sản phẩm
                    </div>
                    <tds-badge *ngIf="quickOrderModel.Details" [standalone]="true" [count]="quickOrderModel.Details.length" [tdsClass]="'bg-success-400 text-white'"></tds-badge>
                </ng-template>
            </tds-collapse>

            <!-- Checkbox tạo hóa đơn bán hàng -->
            <div class="desktop:py-4 laptop:py-3 py-3 bg-primary-3 desktop:px-6 laptop:px-4 px-4 desktop:mt-1 laptop:mt-0.5 mt-0.5">
                <tds-checkbox [(ngModel)]="isEnableCreateOrder" [ngModelOptions]="{standalone: true}" [size]="reponsiveDesktop ? 'md' : 'sm'"
                    (change)="onEnableCreateOrder($event)">
                    <span class="font-semibold desktop:text-body-2 laptop:text-caption-1 text-caption-1">Tạo hóa đơn bán hàng</span>
                </tds-checkbox>
            </div>

            <!-- Giao hàng -->
            <tds-collapse *ngIf="isEnableCreateOrder && saleModel" [expandIconPosition]="'right'" class="bg-white collapse-content-bg-white desktop:mt-1 laptop:mt-0.5 mt-0.5">
              <tds-collapse-panel [header]="headerShip" tdsClass="w-full rounded-b-xl bg-white desktop:px-4 laptop:px-3 px-3 destop:py-4 laptop:py-2 py-2" [tdsHeaderClass]="'desktop:px-4 laptop:px-3 px-3 desktop:py-3 laptop:py-2 py-2'"
                [active]="true" [expandedIcon]="'tdsi-arrow-right-line'">
                  <ng-template #headerShip>
                    <span class="desktop:text-header-1 laptop:text-title-1 text-title-1 font-semibold text-neutral-1-900 font-sans mr-2">Giao hàng</span>
                  </ng-template>

                  <div class="grid desktop:gap-y-2 laptop:gap-y-1.5 gap-y-1.5 items-start w-full" *ngIf="saleModel">
                      <div class="w-full flex flex-col desktop:gap-y-2 laptop:gap-y-1.5 gap-y-1.5">
                          <div class="flex items-center">
                            <span class="desktop:text-body-2 laptop:text-caption-1 text-caption-1 font-semibold">Đối tác giao hàng</span>
                          </div>

                          <div class="col-span-2" *ngIf="lstCarrier">
                              <tds-form-field class="w-full">
                                  <tds-select valueField="Id" textField="Name" placeholder='Chọn đối tác giao hàng'
                                      [size]="reponsiveDesktop ? 'md' : 'sm'"
                                      [valuePrimitive]="false" [allowClear]="true"
                                      [data]="lstCarrier" [ngModel]="saleModel.Carrier"
                                      [ngModelOptions]="{standalone: true}" [allowClear]="true"
                                      (ngModelChange)="onChangeCarrierV2($event)">
                                  </tds-select>
                              </tds-form-field>
                          </div>
                      </div>

                      <!-- thông tin dịch vụ -->
                      <div class="grid desktop:gap-y-4 laptop:gap-y-2 gap-y-2" *ngIf="saleModel.Carrier">

                        <!-- không có dịch vụ -->
                        <div class="w-full" *ngIf="shipServices && shipServices.length == 0 && shipExtraServices && shipExtraServices.length == 0">
                            <span class="desktop:text-body-2 laptop:text-caption-1 text-caption-1 italic">Chưa có dịch vụ nào</span>
                        </div>

                        <!-- danh sách dịch vụ -->
                        <div class="col-span-3 flex flex-row items-center" *ngIf="shipServices && shipServices.length > 0">
                            <span class="w-1/4 font-semibold">Dịch vụ<span class="text-error-400">*</span></span>

                            <tds-form-field class="w-3/4">
                                <tds-select valueField="ServiceId" textField="ServiceName"
                                    (selectChange)="onSelectShipServiceId($event)" placeholder='Chọn dịch vụ'
                                    disabledField="isActive" [valuePrimitive]="false"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    [ngModel]="saleModel.Ship_ServiceId" [ngModelOptions]="{standalone: true}"
                                    [data]="shipServices" [allowClear]="true">

                                    <ng-template tds-label-tmp let-item="item">  {{item.data.ServiceName}}
                                        <span *ngIf="item.data.TotalFee > 0">: {{item.data.TotalFee | numberCustom}}</span>
                                    </ng-template>

                                </tds-select>
                            </tds-form-field>
                        </div>

                        <div class="col-span-3 flex flex-row items-center" *ngIf="insuranceInfo">
                            <span class="w-1/4 font-semibold">Giá trị hàng hóa</span>

                            <div class="flex flex-row items-center gap-x-2 w-3/4">
                              <tds-form-field class="flex flex-auto">
                                  <tds-input-number [min]='0' [step]="1000" placeholder="Nhập phí" [formatter]="numberWithCommas" [parser]="parserComas"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    [classList]="'desktop:text-body-2 laptop:text-caption-1 text-caption-1'"
                                    (ngModelChange)="changeShip_InsuranceFee($event)"
                                    [ngModel]="saleModel.Ship_InsuranceFee" [ngModelOptions]="{standalone: true}">
                                  </tds-input-number>
                              </tds-form-field>

                              <button tds-button-icon tds-tooltip tooltipTitle="Gán bằng tổng giá trị hoá đơn" color="primary"
                                  [size]="reponsiveDesktop ? 'md' : 'sm'"
                                  class="flex items-center justify-center" (click)="signAmountTotalToInsuranceFee()">
                                  <i class="tdsi-in-out-fill text-xl"></i>
                              </button>
                            </div>
                        </div>

                        <ng-container *ngFor="let item of configsProviderDataSource">
                            <div class="col-span-3 flex flex-row items-center" *ngIf="!item.IsHidden">
                                <span class="w-1/4 font-semibold">{{ item.DisplayName }}<span class="text-error-400">*</span></span>
                                <tds-form-field class="w-3/4">
                                    <tds-select valueField="Id" textField="Name" placeholder='Chọn option' [size]="reponsiveDesktop ? 'md' : 'sm'"
                                        [data]="item.ConfigsValue" [ngModel]="item.ConfigValue" (selectChange)="onChangeConfigValue($event, item.ConfigName)" [allowClear]="true"
                                        [ngModelOptions]="{standalone: true}" [allowClear]="item.InputType == 'combo_box'">
                                    </tds-select>
                                </tds-form-field>
                            </div>
                        </ng-container>
                      </div>

                      <div class="grid grid-cols-3 desktop:gap-y-4 laptop:gap-y-1.5 gap-y-1.5 desktop:gap-x-6 laptop:gap-x-4 desktop:mt-2 laptop:mt-1 mt-1">
                        <!-- phí ship đối tác -->
                        <div class="col-span-3 w-full flex flex-row items-center" >
                            <span class="desktop:pr-4 laptop:pr-2 pr-2 font-semibold">Phí ship (đối tác)</span>

                            <div class="col-span-2 flex-auto flex items-center">
                              <div class="desktop:px-4 laptop:px-2 px-2">
                                  <span class="border rounded-md py-1 px-2 text-primary-1">
                                    {{saleModel.CustomerDeliveryPrice || 0 | numberCustom }}đ</span>
                              </div>

                              <div class="desktop:px-4 laptop:px-2 px-2 border-l">
                                  <button *ngIf="!saleModel.TrackingRef && isEnableCalcFee" tds-button-icon color="info" [size]="reponsiveDesktop ? 'md' : 'sm'"  (click)="calcFee()" tds-tooltip="Tính lại tiền ship" type="button">
                                      <span class="flex items-center justify-center">
                                          <i class=" tdsi-reload-fill"></i>
                                      </span>
                                  </button>
                              </div>
                            </div>
                        </div>

                        <div class="col-span-3 w-full flex flex-col">
                            <div class="flex flex-row items-center gap-x-2 w-full">
                              <tds-form-field class="flex flex-auto">
                                <tds-label class="desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1">Khối lượng ship(g)</tds-label>
                                <tds-input-number [min]="0" [step]="1" [(ngModel)]="saleModel.ShipWeight" [formatter]="numberWithCommas" [parser]="parserComas"
                                    [classList]="'desktop:text-body-2 laptop:text-caption-1 text-caption-1'"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    (tdsBlur)="changeShipWeight()" [ngModelOptions]="{standalone: true}">
                                </tds-input-number>
                              </tds-form-field>
                            </div>
                        </div>

                        <div class="col-span-3 w-full flex flex-col">
                            <div class="flex flex-row items-center gap-x-2 w-full">
                              <tds-form-field class="flex flex-auto">
                                <tds-label class="desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1">Phí giao hàng</tds-label>
                                <tds-input-number [min]="0" [step]="1000" [(ngModel)]="saleModel.DeliveryPrice" [formatter]="numberWithCommas" [parser]="parserComas"
                                    [classList]="'desktop:text-body-2 laptop:text-caption-1 text-caption-1'"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    (ngModelChange)="changeDeliveryPrice($event)"[ngModelOptions]="{standalone: true}">
                                </tds-input-number>
                              </tds-form-field>
                            </div>
                        </div>

                        <div class="col-span-3 w-full flex flex-col">
                            <div class="flex flex-row items-center gap-x-2 w-full">
                              <tds-form-field class="flex flex-auto">
                                <tds-label class="desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1">Giao hàng thu tiền</tds-label>
                                <tds-input-number [min]="0" [step]="1000" [(ngModel)]="saleModel.CashOnDelivery" [formatter]="numberWithCommas" [parser]="parserComas"
                                    [classList]="'desktop:text-body-2 laptop:text-caption-1 text-caption-1'"
                                    [size]="reponsiveDesktop ? 'md' : 'sm'"
                                    (ngModelChange)="changeCashOnDelivery($event)" [ngModelOptions]="{standalone: true}">
                                </tds-input-number>
                              </tds-form-field>
                            </div>
                        </div>

                        <div class="col-span-3 w-full flex flex-col">
                            <div class="flex flex-row items-center gap-x-2 w-full">
                              <tds-form-field class="flex flex-auto">
                                <tds-label class="desktop:!text-body-2 laptop:!text-caption-1 !text-caption-1">Ghi chú giao hàng</tds-label>
                                <textarea class="resize-none no-scrollbar desktop:text-body-2 laptop:text-caption-1 text-caption-1" rows="2" tdsInput autocomplete="off"
                                    [(ngModel)]="saleModel.DeliveryNote" [ngModelOptions]="{standalone: true}" placeholder="Nhập ghi chú"></textarea>
                              </tds-form-field>
                            </div>
                        </div>

                        <!-- ship extras service -->
                        <div *ngIf="shipExtraServices && shipExtraServices.length > 0" class="col-span-3">
                            <div class="grid desktop:grid-cols-3 laptop:grid-cols-2 gap-y-2 gap-x-3">
                                <div *ngFor="let child of shipExtraServices; let i=index">
                                    <tds-checkbox [ngModel]="child.IsSelected" [ngModelOptions]="{standalone: true}" (ngModelChange)="changeIsSelectedEx($event, i)">
                                        <div class="flex flex-row items-center w-full">

                                            <span class="mr-2">{{child.Name}}</span>
                                            <div *ngIf="saleModel.Carrier!.DeliveryType === 'ViettelPost' && child.Id == 'XMG' && child.IsSelected == true">
                                                <button type="button" style="border-bottom: dashed 2px #2395FF;" tds-popover
                                                    popoverTrigger="click" (click)="openPopoverShipExtraMoney(child.ExtraMoney)"
                                                    [(popoverVisible)]="visibleShipExtraMoney"
                                                    [popoverContent]="popoverContentShip_ExtraMoney"
                                                    [popoverFooter]="popoverFooterShip_ExtraMoney" [popoverAutoClose]="true"
                                                    [popoverBackdrop]="true" popoverPlacement="right">
                                                    {{(child.ExtraMoney | numberCustom) || 0}}đ
                                                </button>

                                                <!-- popover button Thuế -->
                                                <ng-template #popoverContentShip_ExtraMoney>
                                                    <div class="flex gap-x-2">
                                                        <tds-form-field>
                                                            <tds-input-number [min]='0' [step]="1000" [(ngModel)]="extraMoney"
                                                                [classList]="'desktop:text-body-2 laptop:text-caption-1 text-caption-1'"
                                                                [size]="reponsiveDesktop ? 'md' : 'sm'"
                                                                [formatter]="numberWithCommas" [parser]="parserComas" [ngModelOptions]="{standalone: true}">
                                                            </tds-input-number>
                                                        </tds-form-field>
                                                    </div>
                                                </ng-template>

                                                <ng-template #popoverFooterShip_ExtraMoney>
                                                    <div class="flex justify-end gap-x-2 mt-2">
                                                        <button tds-button-icon color="primary" type="button" (click)="changeShipExtraMoney($event)">
                                                            <span class="flex items-center">
                                                              <i class="tdsi-checkbox-check-fill"></i>
                                                            </span>
                                                        </button>

                                                        <button tds-button-icon color="secondary" type="button" (click)="closePopoverShipExtraMoney()">
                                                            <span class="flex items-center">
                                                                <i class="tdsi-close-fill"></i>
                                                            </span>
                                                        </button>
                                                    </div>
                                                </ng-template>

                                            </div>
                                        </div>
                                    </tds-checkbox>

                                    <span class="desktop:text-body-2 laptop:text-caption-1 text-caption-1 text-primary" *ngIf="child.Fee">{{ child.Fee || 0 | numberCustom }}</span>
                                </div>
                            </div>
                        </div>
                      </div>
                  </div>
              </tds-collapse-panel>
            </tds-collapse>

          <!-- Button Footer conversation all, message, inbox-->
          <div class="flex desktop:gap-x-3 laptop:gap-x-1.5 gap-x-1.5 desktop:py-3 laptop:py-1.5 py-1.5 desktop:px-6 laptop:px-3 px-3 bg-white desktop:mt-1 laptop:mt-0.5 mt-0.5" *ngIf="type != 'post'">
              <button tds-button class="min-w-[100px]" type="button" color="primary" (click)="onSave()">Lưu nháp</button>
              <button *ngIf="isEnableCreateOrder" tds-button class="min-w-[100px]" type="button" color="info" (click)="onSave('SaveAndOpen')">Xác nhận</button>

              <button *ngIf="!isEnableCreateOrder" tds-button class="min-w-[100px]" type="button" color="info" (click)="onSave('SaveAndOpen', 'print', '_click_print')">Lưu và in</button>

              <div class="desktop:gap-x-2 laptop:gap-x-1.5 gap-x-1.5 laptop:flex desktop:hidden flex">
                <button *ngIf="isEnableCreateOrder" tds-button-icon color="primary" type="button" color="secondary" (click)="onSave('SaveAndPrint', 'print')" tds-tooltip="In hóa đơn">
                  <i class="tdsi-paper-fill text-neutral-1-500 text-lg leading-none"></i>
                </button>


                <button *ngIf="isEnableCreateOrder" tds-button-icon color="primary"  type="button" color="secondary" (click)="onSave('SaveAndPrint','printShip')" tds-tooltip="In phiếu ship">
                  <i class="tdsi-truck-fill text-neutral-1-500 text-lg leading-none"></i>
                </button>
              </div>

              <div class="desktop:gap-x-3 laptop:gap-x-1.5 gap-x-1.5 laptop:hidden desktop:flex hidden">
                <button *ngIf="isEnableCreateOrder" tds-button class="min-w-[100px]" type="button" color="secondary" (click)="onSave('SaveAndPrint', 'print')">
                  <span class="flex items-center">
                      <i class="tdsi-paper-fill text-neutral-1-500 text-lg leading-none mr-2"></i>In hóa đơn
                  </span>
                </button>
                <button *ngIf="isEnableCreateOrder" tds-button class="min-w-[100px]" type="button" color="secondary" (click)="onSave('SaveAndPrint','printShip')">
                    <span class="flex items-center">
                        <i class="tdsi-truck-fill text-neutral-1-500 text-lg leading-none mr-2"></i>In phiếu ship
                    </span>
                </button>
              </div>
          </div>

          <!-- Button Footer conversation post-->
          <div class="flex desktop:gap-x-3 laptop:gap-x-1.5 gap-x-1.5 desktop:py-3 laptop:py-1.5 py-1.5 desktop:px-6 laptop:px-3 px-3 bg-white desktop:mt-1 laptop:mt-0.5 mt-0.5" *ngIf="type == 'post' ">
            <button tds-button class="min-w-[100px]" type="button" color="primary" (click)="onSavePost()">Lưu</button>

            <button tds-button class="min-w-[100px]" type="button" color="primary" (click)="onSavePost('SaveAndPrint', 'print', '_click_print')">
               Lưu và in
            </button>

            <button *ngIf="isEnableCreateOrder" tds-button class="min-w-[100px]" type="button" color="secondary" (click)="onSavePost('SaveAndPrint','printShip')">
                <span class="flex items-center">
                    <i class="tdsi-truck-fill text-neutral-1-500 text-lg leading-none mr-2"></i>In phiếu ship
                </span>
            </button>
          </div>

          <!-- Khoản trắng ở cuối giao diện -->
          <div class="flex-auto bg-white desktop:mt-1 laptop:mt-0.5 mt-0.5"></div>
        </div>
    </div>
</tds-spin>
