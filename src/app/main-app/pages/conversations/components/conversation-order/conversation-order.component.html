<tds-spin [spinning]="isLoading">
  <div class="w-full h-[calc(100vh-109px)] bg-neutral-3-100 overflow-y-auto tds-custom-scroll">
    <div class="pt-1">
      <tds-collapse [expandIconPosition]="'right'" class="bg-neutral-3-50">
        <tds-collapse-panel [header]="headerTTKhachHang" [active]="true" [disabled]=false [expandedIcon]="'tdsi-arrow-up-line'">
          <ng-template #headerTTKhachHang>
            <div class="flex items-center">
              <tds-avatar class="bg-primary-1 text-white" icon="tdsi-user-fill"></tds-avatar>
              <div class="ml-2 text-title-1 font-semibold text-neutral-1-900 font-sans">Thông tin khách hàng</div>
            </div>
          </ng-template>

          <div class="flex flex-col gap-4">
            <tds-form-field>
              <input tdsInput autocomplete="off" placeholder="Nguyen Binh"
                [formControl]="name" [required]='true' />
              <span tdsSuffix>
                <tds-tag status='info' type="outline">
                  <span class="flex items-center text-neutral-1-900">
                    <tds-avatar [shape]="'square'" [size]="'sm'"
                      tdsSrc="/assets/images/conversation/fb.svg">
                    </tds-avatar> Facebook: Ngọc Anh Nguyen
                  </span>
                </tds-tag>
              </span>
            </tds-form-field>
            <div class="flex gap-5">
              <tds-form-field class="w-full">
                <div tdsAddOnRight>
                  <i class="tdsi-search-fill text-xl leading-none"></i>
                </div>
                <input tdsInput placeholder="0512783652"
                  [required]='true' [formControl]="phoneNumber" />
              </tds-form-field>

              <tds-form-field>
                <input tdsInput autocomplete="off"  placeholder="Nhập email"
                  [formControl]="email" [required]='true' />
              </tds-form-field>
            </div>

            <div class="flex items-center gap-2">
              <tds-form-field class="w-full">
                <input class="placeholder-neutral-1-400 bg-neutral-3-50" placeholder="Nhập địa chỉ"
                 />
                <span tdsSuffix>
                  <tds-button-group>
                    <div tds-button color="secondary" tds-dropdown trigger="click" [tdsDropdownMenu]="menu" class="p-1 bg-neutral-3-100 rounded">
                      <span class="flex items-center text-caption-2">
                        Mở rộng <i class="tdsi-arrow-down-fill text-lg leading-none ml-1"></i>
                      </span>
                    </div>
                    <tds-dropdown-menu #menu="tdsDropdownMenu">
                      <div class="w-full">
                        <!-- <div (click)="log('1st menu item')" tds-dropdown-item>
                          <a> Item 1 </a>
                        </div>
                        <div (click)="log('2 menu item')" tds-dropdown-item>
                          <a> Item 2 </a>
                        </div>
                        <div (click)="log('3 menu item')" tds-dropdown-item>
                          <a> Item 3 </a>
                        </div>
                        <div (click)="log('4 menu item')" tds-dropdown-item>
                          <a> Item 4 </a>
                        </div> -->
                      </div>
                    </tds-dropdown-menu>
                  </tds-button-group>
                </span>
              </tds-form-field>
              <button tds-button-icon color="primary">
                <span class="flex items-center">
                  <i class="tdsi-location-fill"></i>
                </span>
              </button>
            </div>

            <tds-form-field>
              <tds-select valueField="id" textField="name" placeholder='Nguyen Binh'
                disabledField="isActive" [formControl]="nameSelect" [required]='true'
                [data]="contactCustomer" [allowClear]="true">
              </tds-select>
            </tds-form-field>

            <tds-form-field>
              <textarea tdsInput placeholder="Nhập ghi chú" [formControl]="note"></textarea>
            </tds-form-field>
          </div>
        </tds-collapse-panel>
      </tds-collapse>
    </div>

    <div class="pt-1">
      <tds-collapse [expandIconPosition]="'right'" class="bg-neutral-3-50">
        <tds-collapse-panel [header]="headerSanPham" [active]="true" [disabled]=false [expandedIcon]="'tdsi-arrow-up-line'">
          <ng-template #headerSanPham>
            <div class="flex items-center gap-2">
              <tds-avatar class="bg-primary-1 text-white" icon="tdsi-product-fill"></tds-avatar>
              <div class="text-title-1 font-semibold text-neutral-1-900 font-sans">Sản phẩm</div>
              <div>
                <tds-badge [standalone]="true" [count]="4"
                [tdsClass]="'bg-neutral-1-400 text-white'"></tds-badge>
              </div>
            </div>
          </ng-template>

          <div class="flex flex-col gap-6 w-full h-full">
            <div class="flex gap-1.5">
              <tds-form-field class="w-full">
                <input aria-colspan="" class="placeholder-neutral-1-400"
                  placeholder="Nhập tên sản phẩm" tdsInput />
                <span tdsPrefix ><i class="text-neutral-1-500 tdsi-search-fill text-base"></i></span>
                <span tdsSuffix><i class="tdsi-product-fill"></i></span>
              </tds-form-field>

              <button tds-button-icon color="secondary">
                <span class="flex items-center">
                  <i class="tdsi-add-fill text-primary-1"></i>
                </span>
              </button>

              <button tds-button-icon color="secondary">
                <span class="flex items-center">
                  <i class="tdsi-gear-2-fill text-neutral-1-400"></i>
                </span>
              </button>
            </div>
            <div class="rounded-t-xl h-60 w-full">
              <tds-table #basicTable class="w-full h-full bg-neutral-2-50 px-0.5" [listData]="listOfData" showPagination="false" [scroll]="{y:'auto'}">
                <thead class="bg-neutral-2-50">
                  <tr class="bg-neutral-2-50">
                    <th width="228px" class="bg-neutral-2-50"><div class="uppercase text-caption-2">Sản phẩm</div></th>
                    <th width="88px" class="bg-neutral-2-50"><div class="uppercase text-caption-2">Số lượng</div></th>
                    <th width="137px" class="bg-neutral-2-50"><div class="uppercase text-caption-2">Giá bán</div></th>
                    <th class="bg-neutral-2-50"><i class="tdsi-trash-line text-error-500 text-lg"></i></th>
                  </tr>
                </thead>
                <tbody>
                  <ng-template ngFor let-data [ngForOf]="basicTable.data" >
                    <tr class="bg-white editable-row ">
                      <td class="border-b border-dashed border-neutral-1-200">
                        <div class="text-body-2">
                          {{data.name}}
                          <div  class="editable-cell cursor-pointer flex items-center" [class.hidden]="editNoteProduct === data.id" (click)="startEdit(data.id)" [class]="data.color"><span [class]="data.style">{{data.text}}</span> <span [class]="data.icon" class="text-neutral-1-400 text-lg ml-1"></span></div>
                        </div>
                        <tds-form-field [class.hidden]="editNoteProduct !== data.id" class="pt-2">
                          <input tdsInput placeholder="note" [formControl]="noteProduct" (blur)="stopEdit()" />
                        </tds-form-field>
                      </td>
                      <td class="border-b border-dashed border-neutral-1-200">
                        <tds-form-field>
                          <input tdsInput placeholder="1" [formControl]="soLuongProduct"/>
                        </tds-form-field>
                      </td>
                      <td class="border-b border-dashed border-neutral-1-200">
                        <tds-form-field>
                          <input tdsInput placeholder="100.000" [formControl]="giaBanProduct"/>
                        </tds-form-field>
                      </td>
                      <td class="border-b border-dashed border-neutral-1-200"><i class="tdsi-trash-line text-error-500 text-xl"></i></td>
                    </tr>
                  </ng-template>
                </tbody>
              </tds-table>
            </div>
            <div class="w-ful h-full flex flex-col gap-3 p-4 bg-neutral-2-50 rounded-b-xl">
              <div class="flex w-1/2 gap-2.5 ">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Tổng</div>
                  <div class="w-2/3 flex justify-end text-body-2 font-regular font-sans text-neutral-1-900">
                  300.000
                  </div>
              </div>

              <div class="w-full flex gap-4">
                <div class="w-1/2 gap-2.5 flex items-center">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Giảm giá</div>
                  <div class="w-2/3">
                    <tds-form-field>
                      <input tdsInput autocomplete="off" placeholder="0"
                        [formControl]="giamGia" [required]='true' />
                      <span tdsSuffix><span class="text-body-2 font-semibold font-sans text-primary-1">%</span> <span class="text-body-2 font-semibold font-sans text-neutral-1-400 pl-2">VNĐ</span> </span>
                    </tds-form-field>
                  </div>
                </div>
                <div class="flex w-1/2 gap-2.5 items-center">
                  <div class="w-1/3 text-body-2 font-semibold font-sans text-neutral-1-900">Tổng tiền</div>
                  <div class="w-2/3 flex justify-end text-header-1 font-semibold font-sans text-neutral-1-900">
                    300.000
                  </div>
                </div>
              </div>

              <div class="w-full flex gap-4">
                <div class="w-1/2 gap-2.5 flex items-center">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Thuế</div>
                  <div class="w-2/3">
                    <tds-form-field>
                      <input tdsInput autocomplete="off" placeholder="0"
                        [formControl]="thue" [required]='true' />
                      <span tdsSuffix><i class="tdsi-revenue-fill text-primary-1 text-xl"></i></span>
                    </tds-form-field>
                  </div>
                </div>
                <div class="flex w-1/2 gap-2.5 items-center">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Tiền cọc</div>
                  <div class="w-2/3">
                    <tds-form-field>
                      <input tdsInput autocomplete="off" placeholder="10.000"
                        [formControl]="tienCoc" [required]='true' />
                    </tds-form-field>
                  </div>
                </div>
              </div>

              <div class="w-full flex gap-4">
                <div class="w-1/2 gap-2.5 flex items-center">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Khuyến mãi</div>
                  <div class="w-2/3">
                    <tds-form-field>
                      <input tdsInput autocomplete="off" placeholder="0"
                        [formControl]="khuyenMai" [required]='true' />
                      <span tdsSuffix><i class="tdsi-gift-fill text-primary-1 text-xl"></i></span>
                    </tds-form-field>
                  </div>
                </div>
                <div class="flex w-1/2 gap-2.5 items-center">
                  <div class="w-1/3 text-body-2 font-regular font-sans text-neutral-1-900">Thanh toán</div>
                  <div class="w-2/3">
                    <tds-form-field>
                      <input tdsInput autocomplete="off" placeholder="0"
                        [formControl]="thanhToan" [required]='true' />
                    </tds-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </tds-collapse-panel>
      </tds-collapse>
    </div>
    <div class="pt-1">
      <div class="py-4 bg-primary-3 px-6">
        <tds-checkbox [checked]="true">Tạo hoá đơn bán hàng</tds-checkbox>
      </div>
    </div>
    <div class="pt-1">
      <tds-collapse [expandIconPosition]="'right'" class="bg-neutral-3-50">
        <tds-collapse-panel [header]="headerGiaoHang" [active]="true" [disabled]=false [expandedIcon]="'tdsi-arrow-up-line'">
          <ng-template #headerGiaoHang>
            <div class="flex items-center gap-2">
              <tds-avatar class="bg-primary-1 text-white" icon="tdsi-truck-fill"></tds-avatar>
              <div class="text-title-1 font-semibold text-neutral-1-900 font-sans">Giao hàng</div>
            </div>
          </ng-template>

          <div class="flex flex-col gap-4 w-full h-full">
            <div>
              <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Đối tác giao hàng</div>
              <tds-form-field>
                <tds-select valueField="id" textField="name" placeholder='DHL'
                [formControl]="DTGH" disabledField="isActive" [data]="listDTGiaoHang"
                  [allowClear]="true" [required]="true">
                </tds-select>
              </tds-form-field>
            </div>
            <div>
              <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Giao hàng tiêu chuẩn</div>
              <tds-form-field>
                <tds-select valueField="id" textField="name" placeholder='DHL'
                [formControl]="dichVu" disabledField="isActive" [data]="listDichVu"
                  [allowClear]="true" [required]="true">
                </tds-select>
              </tds-form-field>
            </div>
            <div>
              <tds-checkbox [checked]="true">Cho khách xem hàng?</tds-checkbox>
            </div>
            <div class="flex gap-3 items-center">
              <div class="text-body-2 font-regular font-sans text-info-500">
                Phí ship (đối tác): <span class="pl-2 font-semibold">20.000đ</span>
              </div>
              <button tds-button-icon color="info">
                <span class="flex items-center">
                  <i class="tdsi-reload-fill"></i>
                </span>
              </button>
            </div>

            <div>
              <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Khối lượng (g)</div>
              <div class="flex items-center gap-2">
                <tds-form-field class="w-full">
                  <input tdsInput autocomplete="off"  placeholder="1"  [formControl]="khoiLuong" [required]='true' />
                </tds-form-field>
                <button tds-button-icon color="primary">
                  <span class="flex items-center">
                    <i class="tdsi-location-fill"></i>
                  </span>
                </button>
              </div>
            </div>

            <div class="flex gap-4 w-full">
              <div class="w-1/2">
                <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Phí giao hàng</div>
                <tds-form-field class="w-full">
                  <input tdsInput autocomplete="off"  placeholder="1"  [formControl]="phiGH" [required]='true' />
                </tds-form-field>
              </div>
              <div class="w-1/2">
                <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Tiền thu hộ</div>
                <tds-form-field class="w-full">
                  <input tdsInput autocomplete="off"  placeholder="1"  [formControl]="tienThuHo" [required]='true' />
                </tds-form-field>
              </div>
            </div>
            <div>
              <div class="text-body-2 font-semibold font-sans text-neutral-1-900 pb-2">Ghi chú giao hàng</div>
              <tds-form-field class="w-full">
                <textarea tdsInput placeholder="Nhập ghi chú" [formControl]="notGH"></textarea>
              </tds-form-field>
            </div>
          </div>
        </tds-collapse-panel>
      </tds-collapse>
    </div>
    <div class="pt-1">
      <div class="bg-white py-3 px-6 flex gap-3">
        <button tds-button color="primary">Lưu nháp</button>
        <button tds-button color="info">Xác nhận & in</button>
        <button tds-button color="info">Xác nhận & in ship</button>
      </div>
    </div>
  </div>
</tds-spin>
