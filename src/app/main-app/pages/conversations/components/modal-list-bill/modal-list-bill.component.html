<div class="flex flex-col gap-y-4 text-body-2 max-h-[calc(65vh)] overflow-hidden p-1">
    <div class="flex gap-x-2.5">
        <tds-form-field class="w-full">
            <input tdsInput class="text-neutral-1-600" placeholder="Tìm kiếm" autocomplete="off"
            [(ngModel)]="searchText" [ngModelOptions]="{standalone: true}" [tdsInputDebounce]="750" (inputKeyup)="searchBill()"/>
            <span tdsPrefix><i class="text-neutral-1-600 tdsi-search-fill"></i></span>
        </tds-form-field>
        <button tds-button color="primary" tds-dropdown trigger="click" [tdsDropdownMenu]="menu">
            <span class="flex items-center">
                Sắp xếp
                <i class="tdsi-arrow-down-fill text-lg leading-none ml-2"></i>
            </span>
        </button>
        <tds-dropdown-menu #menu="tdsDropdownMenu">
            <div class="w-40">
                <div *ngFor="let item of sortOptions" tds-dropdown-item (click)="switchSort(item.value)" class="flex items-center justify-between">
                    <a> {{item.text}} </a>
                    <span class="tdsi-success-fill text-success-500" *ngIf="item.value == searchSelect"></span>
                </div>
            </div>
        </tds-dropdown-menu>
    </div>
    <div class="w-full max-h-full overflow-y-auto tds-custom-scroll" id="myScroll" is-lock="true" observe-attributes
    yiAutoScroll lock-y-offset="10" scroll-end="true" (on-change-bottom)="nextData($event)">
        <tds-table #basicTable [listData]="lstBillofPartner" [loading]="isLoading" [showPagination]="false" [pageSize]="lstBillofPartner.length">
            <thead>
                <tr>
                    <th>Mã phiếu</th>
                    <th>Ngày tạo</th>
                    <th>Tổng tiền</th>
                    <th>Trạng thái</th>
                    <th>Thông tin</th>
                    <th>Thanh toán</th>
                    <th>Thao tác</th>
                </tr>
            </thead>
            <tbody>
                <ng-template ngFor let-data [ngForOf]="basicTable.data" let-i="index">
                    <tr>
                        <td>
                            <span class="text-accent-9 ">{{data.Number}}</span>
                        </td>
                        <td>{{data.DateCreated | date:'dd/MM/yyyy'}}</td>
                        <td>{{data.AmountTotal || 0 | numberCustom }} đ</td>
                        <td>
                            <tds-tag [status]='data.ShowState | getColorStatusShowState'>{{data.ShowState}}</tds-tag>
                        </td>
                        <td>
                            <div>
                                <button tds-flat-button color="secondary" rounded="!rounded-full" (click)="showModalDetailBill(data)">
                                    <span class="flex items-center text-info-500">
                                        <i class="tdsi-edit-fill text-xl leading-5 mr-2"></i>Chi tiết
                                    </span>
                                </button>
                            </div>
                        </td>

                        <td>
                            <button tds-button color="secondary" tds-dropdown [backdrop]="true" trigger="click" [tdsDropdownMenu]="menu">
                                <span class="flex items-center">
                                    {{data.PaymentMethod || "Chưa có PTTT"}}
                                    <i class="tdsi-arrow-down-fill text-lg leading-none ml-2"></i>
                                </span>
                            </button>
                            <tds-dropdown-menu #menu="tdsDropdownMenu">
                                <div class="w-full">
                                    <div *ngFor="let item of paymentMethodOptions" tds-dropdown-item (click)="selectPayment(i, item.Text)">
                                        {{item.Text}}
                                    </div>
                                </div>
                            </tds-dropdown-menu>
                        </td>
                        <td>
                            <div class="flex gap-x-2">
                                <button tds-button-icon color="secondary" (click)="showModalSendMessage(data)" tds-tooltip tooltipTitle="Gửi mẫu facebook">
                                    <span class="flex items-center text-neutral-1-500">
                                        <i class="tdsi-facebook-2-fill"></i>
                                    </span>
                                </button>
                                <button tds-button-icon color="secondary" (click)="confirmSubmit(data)" tds-tooltip tooltipTitle="Gửi yêu cầu thanh toán">
                                    <span class="flex items-center text-neutral-1-500">
                                        <i class="tdsi-send-fill"></i>
                                    </span>
                                </button>
                                <button tds-button-icon color="secondary" (click)="onSendImage(data)" tds-tooltip tooltipTitle="Gửi hình ảnh">
                                    <span class="flex items-center text-neutral-1-500">
                                        <i class="tdsi-images-fill"></i>
                                    </span>
                                </button>
                            </div>
                        </td>
                    </tr>
                </ng-template>
            </tbody>
        </tds-table>
    </div>
</div>
<div class="w-full flex justify-end p-4" *tdsModalFooter>
    <button tds-button class="mr-2" color="secondary" (click)="cancel()">Đóng</button>
</div>
