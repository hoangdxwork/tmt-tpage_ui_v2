<tds-spin [spinning]="isLoading">
    <tds-tabset class="border border-neutral-2-100 rounded-md">
    <tds-tab title="Thông tin chung">
        <form [formGroup]="editForm" autocomplete="off" (ngSubmit)="onSubmit()">
            <div class="flex flex-col w-full">
                <div class="mb-4">
                    <img tds-image width="80px" height="80px" 
                       [src]="uploadUrl" />
                </div>
                <tds-form-field class="mb-4">
                    <tds-label>Tên sản phẩm:</tds-label>
                    <input tdsInput formControlName="name" placeholder="Nhập tên sản phẩm" class="text-neutral-1-900 text-body-2 font-regular"/>
                    <tds-error>
                        Vui lòng nhập tên sản phẩm
                    </tds-error>
                </tds-form-field>

                <tds-form-field class="mb-4">
                    <tds-label>Nhóm sản phẩm:</tds-label>
                    <tds-select valueField="Id" textField="Name" placeholder='Chọn nhóm sản phẩm'
                        disabledField="isActive" formControlName="categoryId"
                        [data]="listProductCategory" [allowClear]="true"
                        (selectChange)="onselectProductGroup($event)">
                    </tds-select>
                    <tds-error>
                        Vui lòng chọn nhóm sản phẩm
                    </tds-error>
                </tds-form-field>
        
                <tds-form-field class="mb-4">
                    <tds-label>Đơn vị mua:</tds-label>
                    <tds-select valueField="Id" textField="Name" placeholder='Chọn đơn vị mua'
                        disabledField="isActive" formControlName="UOMId"
                        [data]="listProductUOM" [allowClear]="true"
                        (selectChange)="onselectProductUnit($event)">
                    </tds-select>
                    <tds-error>
                        Vui lòng chọn đơn vị mua
                    </tds-error>
                </tds-form-field>

                <tds-form-field>
                    <tds-label>Giá biến thể:</tds-label>
                    <tds-input-number formControlName="productPrice" [min]="0" class="text-neutral-1-900 text-body-2 font-regular"></tds-input-number>
                    <tds-error>
                        Vui lòng nhập giá biến thể
                    </tds-error>
                </tds-form-field>
            </div>
        </form>
    </tds-tab>
    <tds-tab title="Hình ảnh">
        <div class="w-full">
            <tds-upload
                listType="picture-card" 
                [(fileList)]="imageList"
                [preview]="handlePreview" 
                [download]="handleDownload"
                [customRequest]="handleUpload"
                class="rounded-lg flex flex-wrap">
                                    
                <div class="w-full text-neutral-1-300">
                    <div class="flex items-center justify-center" >
                        <span class="tdsi-images-fill text-xl leading-5"></span>
                    </div>
                    <div class="mt-2 text-body-2 font-regular">Upload</div>
                </div>
            </tds-upload>
            
            <tds-modal [visible]="previewVisible" [content]="modalContent" 
                [footer]="null" (onCancel)="previewVisible = false">
                <ng-template #modalContent>
                    <img [src]="previewImage" [ngStyle]="{ width: '100%' }" />
                </ng-template>
            </tds-modal>
        </div>
    </tds-tab>
    </tds-tabset>
</tds-spin>


<div class="w-full flex justify-end p-4" *tdsModalFooter>
    <button tds-button class="mr-2" color="secondary" (click)="cancel()">
        Hủy bỏ
    </button>
    <button tds-button type="submit" [disabled]="!editForm?.valid" color="primary" (click)="onSave()">
        Lưu thay đổi
    </button>
</div>