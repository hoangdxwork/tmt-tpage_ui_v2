<div #WidthTable class="h-full text-body-2 text-neutral-1-900 pb-2">
  <tds-table #rowSelectionTable [showSizeChanger]="true" [frontPagination]="false" [listData]="lstDeletedOrder"
    [(pageIndex)]="pageIndex" [(pageSize)]="pageSize"
    [scroll]="{y:'auto', x: 'auto'}" [loading]="isLoading" [total]="count" [scroll]="{y:'auto'}"
    (clickRefresh)="refreshData()" (queryParams)="onQueryParamsChange($event)">
    <thead>
      <tr>
        <th [align]="'center'" [width]="'33px'" [tdsLeft]="true" class="border-r"></th>
        <th [(checked)]="checked" [indeterminate]="indeterminate" (checkedChange)="onAllChecked($event)"
          [width]="'42px'" [align]="'center'" [tdsLeft]="true" class="border-r"></th>
        <th [width]="'60px'" class="text-center border-r">STT</th>
        <th [width]="'100px'" class="border-r">Mã</th>
        <th [width]="'150px'" class="border-r">Tên khách hàng</th>
        <th [width]="'140px'" class="border-r">Người xóa</th>
        <th [width]="'250px'" class="border-r">Địa chỉ</th>
        <th [width]="'150px'" class="border-r">
          <div class="flex gap-x-1">
            <span>Ngày tạo</span>
            <span class=" flex flex-col p-0.5 cursor-pointer" (click)="onChangeFilterDate()" tds-tooltip [tooltipTitle]="filterDate | sortDateName">
              <i [ngClass]="filterDate | sortDateClass" class="text-primary-1 tdsi-sort-up-down-fill active text-base leading-4"></i>
            </span>
          </div>
        </th>
        <th [width]="'100px'" class="w-full text-center border-r">Tổng số lượng</th>
        <th [width]="'100px'" class="w-full text-right">Tổng tiền</th>
      </tr>
    </thead>
    <tbody>
      <ng-template ngFor let-order [ngForOf]="rowSelectionTable.data" let-odd='odd' let-index="index">
        <tr [ngClass]="{'tds-row-selected':setOfCheckedId.has(order.OrderId)}">

          <!-- Detail -->
          <td [expand]="expandSet.has(order.OrderId)" class="text-center border-r"
            (expandChange)="onExpandChange(order.OrderId, $event)" [tdsLeft]="true">
          </td>

          <!-- Checked -->
          <td [checked]="setOfCheckedId.has(order.OrderId)" (checkedChange)="onItemChecked(order.OrderId, $event)"
            class="text-center border-r" [tdsLeft]="true">
          </td>

          <!-- STT -->
          <td [tdsLeft]="true" class="text-center border-r"> {{index | numericalOrder :pageSize: pageIndex}} </td>

          <!-- Mã -->
          <td [tdsLeft]="true" class="border-r">{{ order.Code }}</td>

          <!-- Tên khách hàng -->
          <td class="border-r">
            <p class="truncate max-w-[200px]">{{order.PartnerName}}</p>
          </td>

          <!-- Người xóa -->
          <td class="border-r">
            <span *ngIf="order.UserName && !order.IsCancelCheckout; else isUserName">
              {{order.UserName}}
            </span>
            <ng-template #isUserName>
              Người dùng xóa
            </ng-template>
          </td>

          <!-- Địa chỉ -->
          <td class="border-r">{{ order.Address }}</td>

          <!-- Ngày tạo -->
          <td class="border-r">{{order.DateCreated | date: 'dd/MM/yyyy HH:mm'}}</td>

          <!-- Tổng số lượng -->
          <td class="text-center border-r">{{ order.TotalQuantity }}</td>

          <!-- Tổng tiền -->
          <td class="text-right">{{ (order.Total | numberCustom) || 0 }} đ</td>
        </tr>

        <tr [expand]="expandSet.has(order.OrderId)" class="text-neutral-1-900 text-body-2">
            <div class="w-full p-3 block">
              <tds-tabset class="bg-white w-full border rounded-md">
                <tds-tab [title]="'Thông tin'" clsContent="border-t border-neutral-2-200 w-full h-full p-4 -mt-px">
                  <div class="grid grid-cols-3 gap-x-4 mt-4">
                    <div class="col-span-1">
                      <div class="flex items-center gap-x-4 text-sm">
                        <p class="w-1/3">Mã</p>
                        <tds-label class="w-2/3">{{ order.Code || 'N/A'}}</tds-label>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Điện thoại</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Trạng thái</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="grid grid-cols-3 gap-x-4 mt-4">
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Facebook</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Tổng tiền</p>
                          <tds-label class="w-2/3">{{ (order.Total | numberCustom) || 0 }} đ</tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Ngày tạo</p>
                          <tds-label class="w-2/3">{{ order.DateCreated | date: 'dd/MM/yyyy HH:mm' }}</tds-label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="grid grid-cols-3 gap-x-4 mt-4">
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Tên</p>
                          <tds-label class="w-2/3 flex items-center gap-x-2">
                            {{ order.PartnerName ? order.PartnerName : '---' }}
                          </tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Người Xóa</p>
                          <tds-label class="w-2/3">
                            <span *ngIf="order.UserName && !order.IsCancelCheckout; else isUserName">
                              {{order.UserName}}
                            </span>
                            <ng-template #isUserName>
                              Người dùng xóa
                            </ng-template>
                          </tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Kênh bán hàng</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="grid grid-cols-3 gap-x-4 mt-4">
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Người bán</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">
                      <div class="col-span-1">
                        <div class="flex items-center gap-x-4 text-sm">
                          <p class="w-1/3">Ghi chú</p>
                          <tds-label class="w-2/3">{{ '---' }}</tds-label>
                        </div>
                      </div>
                    </div>
                    <div class="col-span-1">

                    </div>
                  </div>
                </tds-tab>
                <tds-tab [title]="'Chi tiết'" clsContent="border-t border-neutral-2-200 w-full h-full p-0 -mt-px">
                  <div class="w-full rounded-md h-[240px]" >
                    <div class="w-full h-full pb-2.5 text-body-2">
                      <tds-table #basicTable [listData]="order.Details" [showPagination]="false" [scroll]="{ y:'200px' }">
                        <thead>
                          <tr>
                            <th width="60px">STT</th>
                            <th width="180px">Mã sản phẩm</th>
                            <th width="180px">Tên sản phẩm</th>
                            <th width="180px">Giá</th>
                            <th width="180px">Số lượng</th>
                            <th width="180px">Đơn vị</th>
                          </tr>
                        </thead>
                        <tbody>
                          <ng-template ngFor let-detail [ngForOf]="basicTable.data" let-index="index">
                            <tr>
                              <td>{{ index + 1 }}</td>
                              <td>{{ detail.ProductId }}</td>
                              <td>{{ detail.ProductName }}</td>
                              <td>{{ detail.Price }}</td>
                              <td>{{ detail.Quantity }}</td>
                              <td>{{ detail.UOMName }}</td>
                            </tr>
                          </ng-template>
                        </tbody>
                      </tds-table>
                    </div>
                  </div>
                </tds-tab>
              </tds-tabset>
            </div>
        </tr>
      </ng-template>
    </tbody>
  </tds-table>
</div>
