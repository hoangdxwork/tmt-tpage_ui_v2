<div class="w-full h-full" #viewCollapse>
  <tds-spin [spinning]="isLoading" class="h-full w-full flex">
    <div class="h-full w-full flex flex-col" *ngIf="dataOverviewReport">
      <div class="flex gap-x-4 items-center">
        <div class="w-1/4 bg-white rounded-xl">
          <div class="w-full h-full flex 2xl:gap-x-6 xl:gap-x-4 p-6 items-start">
            <img src="../../../assets/imagesv2/live-campaign/product.svg" alt="" class="xl:w-[60px] 2xl:w-[80px]">

            <div class="flex flex-col gap-y-2 2xl:text-xl xl:text-body-1 font-semibold w-full">
              <span>Chờ chốt</span>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng đơn</span>
                <span>{{ dataOverviewReport.OrderSummary?.OrderQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng sản phẩm</span>
                <span>{{ dataOverviewReport.OrderSummary?.ProductQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Tổng tiền</span>
                <span class="text-info-500">{{ dataOverviewReport.OrderSummary?.TotalAmount || 0 | numberCustom }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="w-1/4 bg-white rounded-xl">
          <div class="w-full h-full flex 2xl:gap-x-6 xl:gap-x-4 p-6 items-start">
            <img src="../../../assets/imagesv2/live-campaign/money.svg" alt="" class="xl:w-[60px] 2xl:w-[80px]">

            <div class="flex flex-col gap-y-2 2xl:text-xl xl:text-body-1 font-semibold w-full">
              <span>Chờ thanh toán</span>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng đơn</span>
                <span>{{ dataOverviewReport.BillSummary?.OrderQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng sản phẩm</span>
                <span>{{ dataOverviewReport.BillSummary?.ProductQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Tổng tiền</span>
                <span class="text-info-500">{{ dataOverviewReport.BillSummary?.TotalAmount || 0 | numberCustom }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="w-1/4 bg-white rounded-xl">
          <div class="w-full h-full flex 2xl:gap-x-6 xl:gap-x-4 p-6 items-start">
            <img src="../../../assets/imagesv2/live-campaign/turnover.svg" alt="" class="xl:w-[60px] 2xl:w-[80px]">

            <div class="flex flex-col gap-y-2 2xl:text-xl xl:text-body-1 font-semibold w-full">
              <span>Thanh toán</span>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng đơn</span>
                <span>{{ dataOverviewReport.PaySummary?.OrderQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng sản phẩm</span>
                <span>{{ dataOverviewReport.PaySummary?.ProductQuantity || 0 | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Tổng tiền</span>
                <span class="text-info-500">{{ dataOverviewReport.PaySummary?.TotalAmount || 0 | numberCustom }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="w-1/4 bg-white rounded-xl">
          <div class="w-full h-full flex 2xl:gap-x-6 xl:gap-x-4 p-6 items-start">
            <img src="../../../assets/imagesv2/live-campaign/order.svg" alt="" class="xl:w-[60px] 2xl:w-[80px]">

            <div class="flex flex-col gap-y-2 2xl:text-xl xl:text-body-1 font-semibold w-full">
              <span>Tổng hoá đơn</span>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng đơn</span>
                <span>{{ dataOverviewReport.TotalOrderBillSummary?.OrderQuantity | numberCustom  }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Số lượng sản phẩm</span>
                <span>{{ dataOverviewReport.TotalOrderBillSummary?.ProductQuantity | numberCustom }}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-sm text-neutral-1-500 font-normal">Tổng tiền</span>
                <span class="text-info-500">{{ dataOverviewReport.TotalOrderBillSummary?.TotalAmount | numberCustom }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Danh sách sản phẩm -->
      <div class="flex gap-x-4 pt-4 w-full h-full overflow-hidden">
        <div class="w-2/3 h-full bg-white rounded-xl flex flex-col overflow-hidden">
          <div class="p-4 font-semibold text-xl">
            <span>Sản phẩm</span>
          </div>
          <!-- Bảng danh sách sản phẩm -->
          <table-detail-report [liveCampaignId]="liveCampaignId" class="w-full h-full"></table-detail-report>
        </div>

        <!-- Thông tin -->
        <div class="w-1/3 flex flex-col" *ngIf="dataLiveCampaign">
          <div class="p-4 font-semibold text-xl bg-white rounded-t-xl">
            <span>Thông tin</span>
          </div>

          <div class="flex flex-col gap-y-4 p-4 bg-white">
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Tên chiến dịch</span>
              <span class="font-semibold text-sm">{{ dataLiveCampaign?.Name }}</span>
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Facebook</span>
              <span class="font-semibold text-sm text-info-500">{{ dataLiveCampaign?.Facebook_UserName }}</span>
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Live ID</span>
              <span class="font-semibold text-sm">{{ dataLiveCampaign?.Facebook_LiveId || "---" }}</span>
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Ngày tạo</span>
              <span class="font-semibold text-sm">{{ dataLiveCampaign?.DateCreated | date: 'dd/MM/yyyy HH:mm' }}</span>
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Nhân viên chốt đơn</span>
              <div *ngIf="dataLiveCampaign?.Users" class="text-body-2 font-semibold flex gap-x-2">
                <span *ngFor="let user of dataLiveCampaign.Users | slice: 0: 3; let i = index" >
                  {{user.Name}}
                  <span *ngIf="dataLiveCampaign.Users.length > (i + 1)">,</span>
                </span>
    
                <div class="px-1 py-0.5 text-info-500 bg-[#E5F2FF] text-caption-2 rounded cursor-pointer" *ngIf="dataLiveCampaign.Users.length - 3 > 0" tds-popover
                    [popoverContent]="popoverContentTag" popoverPlacement="topRight">
                    +{{dataLiveCampaign.Users.length - 3}}
                </div>
    
                <ng-template #popoverContentTag>
                    <div class="flex gap-1 flex-wrap items-center max-w-[336px]">
                        <div *ngFor="let item of dataLiveCampaign.Users | slice:3:dataLiveCampaign.Users!.length; let i = index" class="relative group flex items-center font-semibold text-body-2 text-neutral-1-900 rounded truncate">
                          {{item.Name }}
                          <span *ngIf="dataLiveCampaign.Users.length > (i + 4)">,</span>
                        </div>
                    </div>
                </ng-template>
              </div>
              
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Trạng thái xác nhận chốt đơn</span>
              <div class="flex items-center gap-x-2">
                <tds-badge [status]="dataLiveCampaign!.ShowConfig | getColorShowConfig"></tds-badge>
                <span class="font-semibold text-sm">{{ dataLiveCampaign?.ShowConfig }}</span>
              </div>
            </div>
            <div class="flex gap-x-4 items-center">
              <span class="w-1/3 text-sm font-normal">Ghi chú</span>
              <span class="font-semibold text-sm">{{ dataLiveCampaign?.Note }}</span>
            </div>
          </div>

          <div class="mt-1 bg-white rounded-b-xl">
            <tds-collapse [expandIconPosition]="'right'" class="bg-white w-full rounded-b-xl">
              <tds-collapse-panel [header]="'Thông tin nâng cao'" [expandedIcon]="'tdsi-arrow-up-line'" [disabled]=false bordered="false">

                <div class="flex flex-col gap-y-4 bg-white">
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Mẫu tin chốt đơn</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.ConfirmedOrder_Template?.Name }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Mẫu tin dự bị</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.Preliminary_Template?.Name }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Thời gian tổng hợp (phút)</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.ResumeTime }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Thời gian kết thúc tổng hợp (phút)</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.EndDate | date: 'dd/MM/yyyy HH:mm' }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Số tiền cọc bắt buộc</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.MaxAmountDepositRequired || 0 | numberCustom }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Số tiền tối thiểu đặt cọc</span>
                    <span class="font-semibold text-sm">{{ dataLiveCampaign?.MinAmountDeposit || 0 | numberCustom }}</span>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Bật số lượng</span>
                    <tds-checkbox [ngModel]="dataLiveCampaign?.EnableQuantityHandling"></tds-checkbox>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Tổng hợp đơn hàng trong thời gian ca làm việc</span>
                    <tds-checkbox [ngModel]="dataLiveCampaign?.IsShift"></tds-checkbox>
                  </div>
                  <div class="flex gap-x-4 items-center">
                    <span class="2xl:w-1/3 xl:w-1/2 text-sm font-normal">Không cho phép gán nhân viên vào cuộc hội thoại</span>
                    <tds-checkbox [ngModel]="dataLiveCampaign?.IsAssignToUserNotAllowed"></tds-checkbox>
                  </div>
                </div>
              </tds-collapse-panel>
            </tds-collapse>
          </div>
        </div>
      </div>
    </div>
  </tds-spin>
</div>
